/*! Qoopido.demand 3.5.7 | https://github.com/dlueth/qoopido.demand | (c) 2016 Dirk Lueth */
!function(e,t,n){"use strict";function r(e,t){return typeof e===t}function i(e){return r(e,y)&&isFinite(e)&&Math.floor(e)===e&&e>=0}function a(e,t,n){for(var r,i=Object.keys(e),a=0;(r=i[a])!==f&&t.call(n,r,e[r])!==h;a++);}function o(e,t,n,r){return{__proto__:s,value:e,enumerable:!!r,configurable:!!n,writable:!!t}}function c(){return+new Date}var u={cache:{},timeout:8e3,pattern:{},modules:{},handler:"module"},l="demand",s=null,f=void 0,h=!1,d=!0,p="undefined",g="string",m="boolean",v="object",x="function",y="number",w=function(){},b="pre",S="post",j="Configure",E=b+j,O=S+j,R="cache",M=R+"Miss",I=R+"Hit",P=R+"Clear",C=R+"Exceed",k=Array.prototype,$=k.slice,_=k.concat,N=(Object.prototype,Object.create,Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertyDescriptor,Function.prototype,function(){function e(e){return n.href=e,n.href}var n=t.createElement("a");return e}()),D=function(){function e(e){return e&&r(e,v)}return e}(),A=function(){function e(e,n){var r,i=this[e];n!==f&&(D(n)?(r=D(i),i=n.length!==f?r&&i.length!==f?i:[]:r&&i.length===f?i:{},this[e]=t(i,n)):this[e]=n)}function t(){for(var t,n=arguments[0],r=1;(t=arguments[r])!==f;r++)a(t,e,n);return n}return t}(),J=function(){function e(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}function t(){}var n=Object.defineProperty,i=new RegExp("[xy]","g"),a={};return t.prototype={generate:function(){var t;do t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,e);while(a[t]);return a[t]=1,t},set:function(e){return r(e.uuid,p)&&n(e,"uuid",new o(this.generate())),e.uuid}},new t}(),U=function(){var n,r,i="setImmediate"in e;return"MutationObserver"in e?function(e){n=t.createElement("div"),new MutationObserver(function(){e()}).observe(n,{attributes:d}),n.setAttribute("i","1")}:!i&&"postMessage"in e&&!("importScripts"in e)&&"addEventListener"in e?function(){function t(t){t.source===e&&t.data&&n[t.data]&&(n[t.data](),delete n[t.data])}var n={};return e.addEventListener("message",t,h),function(t){var r=J.generate();n[r]=t,e.postMessage(r,"*")}}():!i&&"onreadystatechange"in(n=t.createElement("script"))?function(e){n.onreadystatechange=function(){n.onreadystatechange=s,n.parentNode.removeChild(n),e()},t.body.appendChild(n)}:(r=i?setImmediate:setTimeout,function(e){r(e)})}(),F=function(){function e(){l[this.uuid].handle(c,arguments)}function t(){l[this.uuid].handle(u,arguments)}function n(e,t){var n,r,i=this,a=l[i.uuid];for(i.state===o&&(i.state=e,i.value=t);n=a[i.state].shift();)r=n.handler.apply(s,i.value),r&&"function"==typeof r.then?r.then(n.deferred.resolve,n.deferred.reject):n.deferred[i.state===c?"resolve":"reject"].apply(s,i.value);a[c].length=0,a[u].length=0}function r(e,t,n){e.then(function(){n.resolved[t]=$.call(arguments),n.count++,i(n)},function(){n.rejected.push($.call(arguments)),i(n)})}function i(e){e.count===e.total?e.deferred.resolve.apply(s,_.apply([],e.resolved)):e.rejected.length+e.count===e.total&&e.deferred.reject.apply(s,_.apply([],e.rejected))}function a(r){var i=this;l[J.set(i)]={handle:n.bind(i),resolved:[],rejected:[]},r(e.bind(i),t.bind(i))}var o="pending",c="resolved",u="rejected",l={};return a.prototype={state:o,catch:function(e){return this.then(w,e)},always:function(e){return this.then(e,e)},then:function(e,t){var n=this,r=l[n.uuid],i=a.defer();return e&&r[c].push({handler:e,deferred:i}),t&&r[u].push({handler:t,deferred:i}),n.state!==o&&U(r.handle),i.pledge},isPending:function(){return this.state===o},isResolved:function(){return this.state===c},isRejected:function(){return this.state===u}},a.defer=function(){var e={};return e.pledge=new a(function(t,n){e.resolve=t,e.reject=n}),e},a.all=function(e){for(var t,n=a.defer(),i=l[J.generate()]={deferred:n,resolved:[],rejected:[],total:e.length,count:0},o=0;t=e[o];o++)r(t,o,i);return n.pledge},a.race=function(e){for(var t,n=a.defer(),r=0;t=e[r];r++)t.then(n.resolve,n.reject);return n.pledge},a}(),H=/^(http(s?):)?\/\//i,L=function(){function e(e){return e.replace(t,"\\$&")}var t=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;return e}(),T=function(){function e(){var e=this;t[J.set(e)]={}}var t={};return e.prototype={get:function(e){return t[this.uuid][e]},set:function(e,n){t[this.uuid][e]=n}},e}(),q=function(){function e(){}var t=/^cache(Miss|Hit|Clear|Exceed)|(pre|post)(Configure.*|Resolve|Request|Process|Cache)$/,n={};return e.prototype={emit:function(e,t){var r,i,a,o=n[e];if(o)for(r=$.call(arguments,2),i=0;a=o[i];i++)a.filter&&a.filter!==t||a.callback.apply(s,r)},on:function(e,i){var a;if(r(e,g)&&r(i,x))for(e=e.split(" ");a=e.shift();)a=a.split(":"),t.test(a)&&(n[a[0]]||(n[a[0]]=[])).push({callback:i,filter:a[1]})}},new e}(),Q=function(){function t(e){var t;return e.cache!==s?e.cache:(a(u.cache,function(n,r){0===e.path.indexOf(n)&&(!t||r.weight>t.weight)&&(t=r)}),t?t.state:h)}function n(){}var r="["+l+"]",i="[state]",o="[value]",f=new RegExp("^"+L(r)+"\\[(.+?)\\]"+L(i)+"$"),p=function(){try{return"localStorage"in e&&e.localStorage}catch(e){return h}}(),g=p&&"remainingSpace"in localStorage;return n.prototype={get:function(){return p?function(e){var n,a;if(t(e)){if(n=r+"["+e.path+"]",a=JSON.parse(localStorage.getItem(n+i)),a&&a.version===e.version&&a.url===e.url&&(!a.expires&&!e.lifetime||a.expires>c()))return q.emit(I,e.path,e),localStorage.getItem(n+o);q.emit(M,e.path,e),a&&this.clear.path(e.path)}else q.emit(M,e.path,e)}:function(e){q.emit(M,e.path,e)}}(),set:function(){return p?function(e,n){var a,u;if(t(e)){a=r+"["+e.path+"]";try{if(u=g?localStorage.remainingSpace:s,localStorage.setItem(a+o,n),localStorage.setItem(a+i,JSON.stringify({version:e.version,expires:e.lifetime?c()+e.lifetime:e.lifetime,url:e.url})),u!==s&&localStorage.remainingSpace===u)throw new Error("QUOTA_EXCEEDED_ERR");return d}catch(t){q.emit(C,e.path,e)}}}:w}(),clear:{path:function(){return p?function e(e){var t=r+"["+e+"]";localStorage.removeItem(t+i),localStorage.removeItem(t+o),q.emit(P,e)}:w}(),all:function(){return p?function(){var e;a(localStorage,function(t){e=t.match(f),e&&this.path(e[1])},this)}:w}(),expired:function(){return p?function(){var e,t;a(localStorage,function(n){e=n.match(f),e&&(t=JSON.parse(localStorage.getItem(r+"["+e[1]+"]"+i)),t&&t.expires>0&&t.expires<=c()&&this.path(e[1]))},this)}:w}()}},new n}(),X=function(){function e(e,t){var n=e.replace(r,"");return o.test(n)||H.test(n)||(n="/"+N((t&&N(t+"/../")||"/")+n).replace(a,"")),n}function t(t,n){var a=this,o=t.match(r);return a.deferred=F.defer(),a.pledge=a.deferred.pledge,a.path=e(t,n),a.mock=o&&o[1]?d:h,a.cache=o&&o[2]?"+"===o[2]:s,a.handler=o&&o[3]||u.handler,a.version=o&&o[4]||u.version,a.lifetime=o&&o[5]&&1e3*o[5]||u.lifetime,a.uri=(a.mock?"mock:":"")+a.handler+"@"+a.version+(i(a.lifetime)&&a.lifetime>0?"#"+a.lifetime:"")+"!"+a.path,Q.get(a),a}var n=new T,r=/^(mock:)?([+-])?((?:[-\w]+\/?)+)?(?:@(\d+\.\d+.\d+))?(?:#(\d+))?!/,a=new RegExp("^"+L(N("/"))),o=/^\//;return t.resolve=function(r,i){var a=e(r,i),o=n.get(a);return o||(o=new t(r,i)),o.pledge},t}(),z=function(){function e(e,n){var r=this;r.weight=e.length,r.url=N(n).replace(t,"$1"),r.matchPattern=new RegExp("^"+L(e)),r.matchUrl=new RegExp("^"+L(n))}var t=/(.+)\/$/;return e.prototype={matches:function(e){return this.matchPattern.test(e)},remove:function(e){return e.replace(this.matchUrl,"")},process:function(e){return e.replace(this.matchPattern,this.url)}},e}(),B=function(){function e(e){var t,n=this;H.test(e.path)||a(u.pattern,function(n,r){r.matches(e.path)&&(!t||t.weight<r.weight)&&(t=r)}),n.dependency=e,n.pattern=t,n.url=t?N(t.process(e.path)):e.path,console.log("hier",n)}return e}(),G=function(){function t(){for(var t,n=$.call(arguments),r=this!==e?this:s,i=0;t=n[i];i++)n[i]=X.resolve(t,r);return F.all(n)}return t.configure=function(e){var n,o=e.cache,c=e.version,l=e.timeout,s=e.lifetime,f=e.base,h=e.pattern,d=e.modules,p=u.modules;return r(o,m)?u.cache[""]={weight:0,state:o}:D(o)&&a(o,function(e,t){u.cache[e]={weight:e.length,state:t}}),r(c,g)&&(u.version=c),i(l)&&(u.timeout=1e3*Math.min(Math.max(l,2),12)),i(s)&&s>0&&(u.lifetime=1e3*s),r(f,g)&&""!==f&&(u.pattern.base=new z("",f)),D(h)&&a(h,function(e,t){"base"!==e&&(u.pattern[e]=new z(e,t))}),D(d)&&a(d,function(e,t){n=p[e]=p[e]||{},q.emit(E,e,n),A(n,t),q.emit(O,e,n)}),t},t.on=function(e,n){return q.on(e,n),t},t.on(M,function(e){new B(e)}),t}();!function(){e.demand=G,G.configure({cache:d,base:"/",pattern:{"/demand":N((n&&n.url||location.href)+"/../").slice(0,-1)}}),n&&n.settings&&G.configure(n.settings),n&&n.main&&G(n.main)}()}(this,document,"demand"in this&&demand);
//# sourceMappingURL=demand.js.map
