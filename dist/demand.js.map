{"version":3,"sources":["demand.js"],"names":["global","document","configuration","JSON","arrayPrototype","objectPrototype","setTimeout","undefined","emit","event","parameter","i","callback","pointer","listener","arrayPrototypeSlice","call","arguments","apply","NULL","log","error","isTypeOf","console","toString","mock","module","pledge","pledges","match","regexMatchParameter","replace","mocks","Pledge","defer","slice","join","push","demand","all","escapeRegularExpression","value","regexMatchRegex","createRegularExpression","expression","modifier","RegExp","getTimestamp","Date","resolveUrl","url","resolver","href","resolveDependency","dependency","context","path","definition","deferred","STRING_STRING","resolvePath","Module","regexMatchInternal","test","DEMAND_ID","MODULE_PREFIX_LOCAL","scopedDemand","bind","iterate","property","PROVIDE_ID","provide","PATH_ID","MODULE_PREFIX_PATHS","registry","Loader","resolveParameter","isInstanceOf","resolve","regexIsAbsolutePath","regexIsAbsoluteUri","regexMatchBaseUrl","pattern","settings","matches","weight","cache","handler","version","lifetime","process","mergeProperties","targetPropertyIsObject","targetProperty","this","isObject","length","merge","isArray","objectPrototypeToString","object","type","isPositiveInteger","isFinite","Math","floor","properties","target","Object","keys","hash","input","charCodeAt","self","dependencies","window","isFunction","queueHandler","current","Failure","STRING_FUNCTION","isPending","then","Uuid","Queue","QueueHandler","Pattern","Xhr","queue","storage","arrayPrototypeConcat","concat","MODULE_PREFIX","MODULE_PREFIX_STORAGE","MODULE_PREFIX_HANDLER","MODULE_PREFIX_PLUGIN","MODULE_PREFIX_FUNCTION","MODULE_PREFIX_VALIDATOR","STRING_BOOLEAN","regexMatchSourcemap","regexMatchEvent","timeout","modules","createElement","element","fallback","hasSetImmediate","fn","MutationObserver","observe","attributes","setAttribute","onMessage","source","data","addEventListener","uuid","generate","postMessage","onreadystatechange","parentNode","removeChild","body","appendChild","setImmediate","prototype","randomize","character","r","random","objectDefineProperty","defineProperty","regex","result","set","__proto__","enumerable","configurable","writable","handle","PLEDGE_RESOLVED","reject","PLEDGE_REJECTED","state","PLEDGE_PENDING","shift","index","resolved","count","check","rejected","total","executor","catch","always","alwaysListener","resolveListener","rejectListener","isResolved","isRejected","race","enqueue","dequeue","regexMatchTrailingSlash","matchPattern","matchUrl","remove","XMLHttpRequest","checkState","readyState","abort","XDomainRequest","boundCheckState","xhr","ontimeout","onerror","onabort","status","onprogress","clearTimeout","onload","responseText","getResponseHeader","open","send","resolveLoader","loader","onPreProcess","onPreRequest","get","response","matchType","onPostRequest","message","stack","traverse","depth","item","indention","Array","configure","temp","base","min","max","clean","on","events","split","indexOf","substr","list","isEnabled","Storage","clear","expired","STORAGE_PREFIX","STORAGE_SUFFIX_STATE","STORAGE_SUFFIX_VALUE","regexMatchState","localStorage","exception","hasRemainingSpace","exists","parse","getItem","expires","id","spaceBefore","remainingSpace","setItem","stringify","Error","removeItem","getElementsByTagName","replacement","exec","protocol","host","script","async","text","handlerModule","options","prefix","generateConfiguration","bundle","/demand/handler/bundle","getModule","resolveDependencies","rejectDependencies","bundles","assignModule","factory","/demand","location","main"],"mappings":"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","file":"demand.js","sourcesContent":["/**\n * Qoopido demand\n *\n * Promise like module loader (XHR) with localStorage caching\n *\n * Copyright (c) 2016 Dirk Lueth\n *\n * Dual licensed under the MIT and GPL licenses.\n *  - http://www.opensource.org/licenses/mit-license.php\n *  - http://www.gnu.org/copyleft/gpl.html\n *\n * @author Dirk Lueth <info@qoopido.com>\n *\n * @todo add garbage collection to storage (based on \"last access\")\n * @todo check genie for what happens if a single module is in cache, but not yet requested\n */\n\n(function(global, document, configuration, JSON, arrayPrototype, objectPrototype, setTimeout, undefined) {\n\t'use strict';\n\n\tvar /** shortcuts */\n\t\t\tarrayPrototypeSlice     = arrayPrototype.slice,\n\t\t\tarrayPrototypeConcat    = arrayPrototype.concat,\n\t\t\tobjectPrototypeToString = objectPrototype.toString,\n\t\t/** constants */\n\t\t\tDEMAND_ID               = 'demand',\n\t\t\tPROVIDE_ID              = 'provide',\n\t\t\tPATH_ID                 = 'path',\n\t\t\tMODULE_PREFIX           = '/' + DEMAND_ID + '/',\n\t\t\tMODULE_PREFIX_STORAGE   = MODULE_PREFIX + 'storage/',\n\t\t\tMODULE_PREFIX_HANDLER   = MODULE_PREFIX + 'handler/',\n\t\t\tMODULE_PREFIX_PLUGIN    = MODULE_PREFIX + 'plugin/',\n\t\t\tMODULE_PREFIX_LOCAL     = MODULE_PREFIX + 'local',\n\t\t\tMODULE_PREFIX_PATHS     = MODULE_PREFIX + 'paths',\n\t\t\tMODULE_PREFIX_FUNCTION  = MODULE_PREFIX + 'function/',\n\t\t\tMODULE_PREFIX_VALIDATOR = MODULE_PREFIX + 'validator/',\n\t\t\tSTRING_STRING           = 'string',\n\t\t\tSTRING_BOOLEAN          = 'boolean',\n\t\t\tSTRING_FUNCTION         = 'function',\n\t\t\tNULL                    = null,\n\t\t/** regular expressions */\n\t\t\tregexIsAbsolutePath     = /^\\//,\n\t\t\tregexIsAbsoluteUri      = /^(http(s?):)?\\/\\//i,\n\t\t\tregexMatchParameter     = /^(mock:)?([+-])?((?:[-\\w]+\\/?)+)?(?:@(\\d+\\.\\d+.\\d+))?(?:#(\\d+))?!/,\n\t\t\tregexMatchRegex         = /[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,\n\t\t\tregexMatchSourcemap     = /\\/\\/#\\s+sourceMappingURL\\s*=\\s*(?!(?:http[s]?:)?\\/\\/)(.+?)\\.map/g,\n\t\t\tregexMatchEvent         = /^cache(Miss|Hit|Clear|Exceed)|(pre|post)(Configure.*|Resolve|Request|Process|Cache)$/,\n\t\t\tregexMatchInternal      = new RegExp('^' + DEMAND_ID + '|' + PROVIDE_ID + '|' + PATH_ID + '$'),\n\t\t\tregexMatchBaseUrl,\n\t\t/** classes */\n\t\t\tUuid, Pledge, Queue, QueueHandler, Pattern, Xhr, Loader, Failure,\n\t\t/** instances */\n\t\t\tqueue, queueHandler, storage,\n\t\t/** conditional functions */\n\t\t\tdefer,\n\t\t/** other */\n\t\t\tsettings                = { cache: {}, timeout: 8 * 1000, pattern: {}, modules: {}, handler: 'module' },\n\t\t\tresolver                = document.createElement('a'),\n\t\t\tregistry                = {},\n\t\t\tmocks                   = {},\n\t\t\tlistener                = {}\n\t\t\t;\n\n\t/**\n\t * --------------------------------\n\t * Functions\n\t * --------------------------------\n\t */\n\t\t/**\n\t\t * Private\n\t\t */\n\t\t\tfunction emit(event) {\n\t\t\t\tvar pointer = listener[event],\n\t\t\t\t\tparameter, i, callback;\n\n\t\t\t\tif(pointer) {\n\t\t\t\t\tparameter = arrayPrototypeSlice.call(arguments, 1);\n\n\t\t\t\t\tfor(i = 0; (callback = pointer[i]); i++) {\n\t\t\t\t\t\tcallback.apply(NULL, parameter);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction log(error) {\n\t\t\t\t/* eslint-disable no-console */\n\t\t\t\tif(!isTypeOf(console, 'undefined')) {\n\t\t\t\t\tconsole.error(error.toString());\n\t\t\t\t}\n\t\t\t\t/* eslint-enable no-console */\n\t\t\t}\n\n\t\t\tfunction mock() {\n\t\t\t\tvar pledges = [],\n\t\t\t\t\ti = 0, module, pledge, parameter;\n\n\t\t\t\tfor(; (module = arguments[i]); i++) {\n\t\t\t\t\tparameter    = module.match(regexMatchParameter);\n\t\t\t\t\tmodule       = module.replace(regexMatchParameter, '');\n\t\t\t\t\tpledge       = (mocks[module] || (mocks[module] = Pledge.defer())).pledge;\n\t\t\t\t\targuments[i] = (parameter ? 'mock:' + parameter.slice(1).join('')  : 'mock:') + '!' + module;\n\n\t\t\t\t\tpledges.push(pledge);\n\t\t\t\t}\n\n\t\t\t\tdemand.apply(NULL, arguments);\n\n\t\t\t\treturn Pledge.all(pledges);\n\t\t\t}\n\n\t\t\tfunction escapeRegularExpression(value) {\n\t\t\t\treturn value.replace(regexMatchRegex, '\\\\$&');\n\t\t\t}\n\n\t\t\tfunction createRegularExpression(expression, modifier) {\n\t\t\t\treturn new RegExp(expression, modifier);\n\t\t\t}\n\n\t\t\tfunction getTimestamp() {\n\t\t\t\treturn +new Date();\n\t\t\t}\n\n\t\t\tfunction resolveUrl(url) {\n\t\t\t\tresolver.href = url;\n\n\t\t\t\treturn resolver.href;\n\t\t\t}\n\n\t\t\tfunction resolveDependency(dependency, context) {\n\t\t\t\tvar path, definition, deferred;\n\n\t\t\t\tif(isTypeOf(dependency, STRING_STRING)) {\n\t\t\t\t\tpath = resolvePath(dependency, context);\n\n\t\t\t\t\tnew Module(dependency, context);\n\n\t\t\t\t\tif(context && regexMatchInternal.test(dependency)) {\n\t\t\t\t\t\tswitch(dependency) {\n\t\t\t\t\t\t\tcase DEMAND_ID:\n\t\t\t\t\t\t\t\tpath       = MODULE_PREFIX_LOCAL + path;\n\t\t\t\t\t\t\t\tdefinition = function() {\n\t\t\t\t\t\t\t\t\tvar scopedDemand = demand.bind(context);\n\n\t\t\t\t\t\t\t\t\titerate(demand, function(property, value) {\n\t\t\t\t\t\t\t\t\t\tscopedDemand[property] = value;\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\treturn scopedDemand;\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase PROVIDE_ID:\n\t\t\t\t\t\t\t\tpath       = MODULE_PREFIX_LOCAL + path;\n\t\t\t\t\t\t\t\tdefinition = function() {\n\t\t\t\t\t\t\t\t\treturn provide.bind(context);\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase PATH_ID:\n\t\t\t\t\t\t\t\tpath       = MODULE_PREFIX_PATHS + context;\n\t\t\t\t\t\t\t\tdefinition = function() {\n\t\t\t\t\t\t\t\t\treturn context;\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t!registry[path] && provide(path, definition);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (registry[path] || (registry[path] = new Loader(path, resolveParameter(dependency, context)))).pledge;\n\t\t\t\t} else {\n\t\t\t\t\tif(!isInstanceOf(dependency, Pledge)) {\n\t\t\t\t\t\tdeferred = Pledge.defer();\n\n\t\t\t\t\t\tdeferred.resolve(dependency);\n\n\t\t\t\t\t\treturn deferred.pledge;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn dependency;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction resolvePath(path, context) {\n\t\t\t\tpath = path.replace(regexMatchParameter, '');\n\n\t\t\t\tif(!regexIsAbsolutePath.test(path) && !regexIsAbsoluteUri.test(path)) {\n\t\t\t\t\tpath = '/' + resolveUrl(((context && resolveUrl(context + '/../')) || '/') + path).replace(regexMatchBaseUrl, '');\n\t\t\t\t}\n\n\t\t\t\treturn path;\n\t\t\t}\n\n\t\t\tfunction resolveParameter(path, context) {\n\t\t\t\tvar parameter = path.match(regexMatchParameter),\n\t\t\t\t\tpattern   = settings.pattern,\n\t\t\t\t\tmatch;\n\n\t\t\t\tpath = resolvePath(path, context);\n\n\t\t\t\tif(!regexIsAbsoluteUri.test(path)) {\n\t\t\t\t\titerate(pattern, function(property, value) {\n\t\t\t\t\t\tvalue.matches(path) && (!match || match.weight < value.weight) && (match = value);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tpath:     path,\n\t\t\t\t\tmock:     (parameter && parameter[1]) ? true : false,\n\t\t\t\t\tcache:    (parameter && parameter[2]) ? parameter[2] === '+' : NULL,\n\t\t\t\t\thandler:  (parameter && parameter[3]) || settings.handler,\n\t\t\t\t\tversion:  (parameter && parameter[4]) || settings.version,\n\t\t\t\t\tlifetime: (parameter && parameter[5] && parameter[5] * 1000) || settings.lifetime,\n\t\t\t\t\turl:      match ? resolveUrl(match.process(path)) : path\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction mergeProperties(property, value) {\n\t\t\t\tvar targetProperty = this[property],\n\t\t\t\t\ttargetPropertyIsObject;\n\n\t\t\t\tif(value !== undefined) {\n\t\t\t\t\tif(isObject(value)) {\n\t\t\t\t\t\ttargetPropertyIsObject = isObject(targetProperty);\n\n\t\t\t\t\t\tif(value.length !== undefined) {\n\t\t\t\t\t\t\ttargetProperty = (targetPropertyIsObject && targetProperty.length !== undefined) ? targetProperty : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttargetProperty = (targetPropertyIsObject && targetProperty.length === undefined) ? targetProperty : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis[property] = merge(targetProperty, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis[property] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t/**\n\t\t * Public\n\t\t */\n\t\t\t/**\n\t\t\t * isArray\n\t\t\t *\n\t\t\t * Check whether a given value is of type array\n\t\t\t *\n\t\t\t * @param value\n\t\t\t *\n\t\t\t * @return {boolean}\n\t\t\t */\n\t\t\tfunction isArray(value) {\n\t\t\t\treturn objectPrototypeToString.call(value) === '[object Array]';\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * isObject\n\t\t\t *\n\t\t\t * Check whether a given object is of type object\n\t\t\t *\n\t\t\t * @param object\n\t\t\t *\n\t\t\t * @return {boolean}\n\t\t\t */\n\t\t\tfunction isObject(object) {\n\t\t\t\treturn object && isTypeOf(object, 'object');\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * isTypeOf\n\t\t\t *\n\t\t\t * Check whether a given object is of specified type\n\t\t\t *\n\t\t\t * @param object\n\t\t\t * @param {string} type\n\t\t\t *\n\t\t\t * @return {boolean}\n\t\t\t */\n\t\t\tfunction isTypeOf(object, type) {\n\t\t\t\treturn typeof object === type;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * isInstanceOf\n\t\t\t *\n\t\t\t * Check whether a given object is an instance of specified type\n\t\t\t *\n\t\t\t * @param object\n\t\t\t * @param module\n\t\t\t *\n\t\t\t * @return {boolean}\n\t\t\t */\n\t\t\tfunction isInstanceOf(object, module) {\n\t\t\t\treturn object instanceof module;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * isPositiveInteger\n\t\t\t *\n\t\t\t * Check whether a given value is a positive integer\n\t\t\t *\n\t\t\t * @param value\n\t\t\t *\n\t\t\t * @return {boolean}\n\t\t\t */\n\t\t\tfunction isPositiveInteger(value) {\n\t\t\t\treturn isTypeOf(value, 'number') && isFinite(value) && Math.floor(value) === value && value >= 0;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * merge\n\t\t\t *\n\t\t\t * Merge two or more objects into the first one passed in\n\t\t\t *\n\t\t\t * @param {...object} object\n\t\t\t *\n\t\t\t * @return {object}\n\t\t\t */\n\t\t\tfunction merge() {\n\t\t\t\tvar target = arguments[0],\n\t\t\t\t\ti = 1, properties;\n\n\t\t\t\tfor(; (properties = arguments[i]) !== undefined; i++) {\n\t\t\t\t\titerate(properties, mergeProperties, target);\n\t\t\t\t}\n\n\t\t\t\treturn target;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * iterate\n\t\t\t *\n\t\t\t * Iterate over enumerable & own properties of a given\n\t\t\t * object and pass current property as well as its value\n\t\t\t * to a callback function\n\t\t\t *\n\t\t\t * @param {object} object\n\t\t\t * @param {function} callback\n\t\t\t * @param context\n\t\t\t *\n\t\t\t * @return {object}\n\t\t\t */\n\t\t\tfunction iterate(object, callback, context) {\n\t\t\t\tvar properties = Object.keys(object),\n\t\t\t\t\ti = 0, property;\n\n\t\t\t\tfor(; (property = properties[i]) !== undefined; i++) {\n\t\t\t\t\tif(callback.call(context, property, object[property]) === false) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * hash\n\t\t\t *\n\t\t\t * Generate a hash for a given string\n\t\t\t *\n\t\t\t * @param {string} input\n\t\t\t *\n\t\t\t * @return {number}\n\t\t\t */\n\t\t\tfunction hash(input){\n\t\t\t\tvar value = 5381,\n\t\t\t\t\ti     = input.length;\n\n\t\t\t\twhile(i) {\n\t\t\t\t\tvalue = (value * 33) ^ input.charCodeAt(--i);\n\t\t\t\t}\n\n\t\t\t\treturn value >>> 0;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * defer\n\t\t\t *\n\t\t\t * delay function execution like setImmediate does\n\t\t\t *\n\t\t\t * @param {function} function\n\t\t\t */\n\t\t\tdefer = (function() {\n\t\t\t\tvar hasSetImmediate = 'setImmediate' in global,\n\t\t\t\t\telement, fallback;\n\n\t\t\t\tif('MutationObserver' in global) {\n\t\t\t\t\treturn function(fn) {\n\t\t\t\t\t\telement = document.createElement('div');\n\n\t\t\t\t\t\tnew MutationObserver(function() { fn(); })\n\t\t\t\t\t\t\t.observe(element, { attributes: true });\n\n\t\t\t\t\t\telement.setAttribute('i', '1');\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif(!hasSetImmediate && 'postMessage' in global && !('importScripts' in global) && 'addEventListener' in global) {\n\t\t\t\t\treturn (function() {\n\t\t\t\t\t\tvar storage = {};\n\n\t\t\t\t\t\tfunction onMessage(event) {\n\t\t\t\t\t\t\tif(event.source === global && event.data && storage[event.data]) {\n\t\t\t\t\t\t\t\tstorage[event.data]();\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdelete storage[event.data];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tglobal.addEventListener('message', onMessage, false);\n\n\t\t\t\t\t\treturn function(fn) {\n\t\t\t\t\t\t\tvar uuid = Uuid.generate();\n\n\t\t\t\t\t\t\tstorage[uuid] = fn;\n\n\t\t\t\t\t\t\tglobal.postMessage(uuid, '*');\n\t\t\t\t\t\t}\n\t\t\t\t\t}());\n\t\t\t\t}\n\n\t\t\t\tif(!hasSetImmediate && 'onreadystatechange' in (element = document.createElement('script'))) {\n\t\t\t\t\treturn function(fn) {\n\t\t\t\t\t\telement.onreadystatechange = function onreadystatechange() {\n\t\t\t\t\t\t\telement.onreadystatechange = NULL;\n\t\t\t\t\t\t\telement.parentNode.removeChild(element);\n\n\t\t\t\t\t\t\tfn();\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tdocument.body.appendChild(element);\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t/* eslint-disable no-undef */\n\t\t\t\tfallback = hasSetImmediate ? setImmediate : setTimeout;\n\t\t\t\t/* eslint-enable no-undef */\n\n\t\t\t\treturn function(fn) {\n\t\t\t\t\tfallback(fn);\n\t\t\t\t}\n\t\t\t}());\n\t\n\t/**\n\t * --------------------------------\n\t * Classes\n\t * --------------------------------\n\t */\n\t\t/**\n\t\t * Module\n\t\t */\n\t\t\tfunction Module(path, context) {\n\t\t\t\tvar self      = this,\n\t\t\t\t\tparameter = path.match(regexMatchParameter);\n\n\t\t\t\tpath = resolvePath(path, context);\n\n\t\t\t\tself.path     = path;\n\t\t\t\tself.mock     = (parameter && parameter[1]) ? true : false;\n\t\t\t\tself.cache    = (parameter && parameter[2]) ? parameter[2] === '+' : NULL;\n\t\t\t\tself.handler  = (parameter && parameter[3]) || settings.handler;\n\t\t\t\tself.version  = (parameter && parameter[4]) || settings.version;\n\t\t\t\tself.lifetime = (parameter && parameter[5] && parameter[5] * 1000) || settings.lifetime;\n\t\t\t}\n\n\t\t\tModule.prototype = {\n\t\t\t\t/* only for reference\n\t\t\t\t path:     NULL,\n\t\t\t\t mock:     NULL,\n\t\t\t\t cache:    NULL,\n\t\t\t\t handler:  NULL,\n\t\t\t\t version:  NULL,\n\t\t\t\t lifetime: NULL\n\t\t\t\t */\n\t\t\t};\n\n\t\t/**\n\t\t * Uuid\n\t\t */\n\t\t\tUuid = (function() {\n\t\t\t\tvar objectDefineProperty = Object.defineProperty,\n\t\t\t\t\tregex                = new RegExp('[xy]', 'g'),\n\t\t\t\t\tstorage              = {};\n\n\t\t\t\tfunction randomize(character) {\n\t\t\t\t\tvar r = Math.random() * 16 | 0;\n\n\t\t\t\t\treturn ((character === 'x') ? r : (r & 0x3 | 0x8)).toString(16);\n\t\t\t\t}\n\n\t\t\t\tfunction Uuid() {}\n\n\t\t\t\tUuid.prototype = {\n\t\t\t\t\tgenerate: function() {\n\t\t\t\t\t\tvar result;\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tresult = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, randomize);\n\t\t\t\t\t\t} while(storage[result]);\n\n\t\t\t\t\t\tstorage[result] = 1;\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t},\n\t\t\t\t\tset: function(target) {\n\t\t\t\t\t\tif(typeof target.uuid === 'undefined') {\n\t\t\t\t\t\t\tobjectDefineProperty(target, 'uuid', {\n\t\t\t\t\t\t\t\t__proto__:    NULL,\n\t\t\t\t\t\t\t\tvalue:        this.generate(),\n\t\t\t\t\t\t\t\tenumerable:   false,\n\t\t\t\t\t\t\t\tconfigurable: false,\n\t\t\t\t\t\t\t\twritable:     false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn target.uuid;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn new Uuid();\n\t\t\t}());\n\n\t\t/**\n\t\t * Pledge\n\t\t */\n\t\t\tPledge = (function() {\n\t\t\t\tvar PLEDGE_PENDING  = 'pending',\n\t\t\t\t\tPLEDGE_RESOLVED = 'resolved',\n\t\t\t\t\tPLEDGE_REJECTED = 'rejected',\n\t\t\t\t\tfn              = function() {},\n\t\t\t\t\tstorage         = {};\n\n\t\t\t\tfunction resolve() {\n\t\t\t\t\tstorage[this.uuid].handle(PLEDGE_RESOLVED, arguments);\n\t\t\t\t}\n\n\t\t\t\tfunction reject() {\n\t\t\t\t\tstorage[this.uuid].handle(PLEDGE_REJECTED, arguments);\n\t\t\t\t}\n\n\t\t\t\tfunction handle(state, parameter) {\n\t\t\t\t\tvar self     = this,\n\t\t\t\t\t\tlistener = storage[self.uuid],\n\t\t\t\t\t\tpointer, result;\n\n\t\t\t\t\tif(self.state === PLEDGE_PENDING) {\n\t\t\t\t\t\tself.state = state;\n\t\t\t\t\t\tself.value = parameter;\n\t\t\t\t\t}\n\n\t\t\t\t\twhile(pointer = listener[self.state].shift()) {\n\t\t\t\t\t\tresult = pointer.handler.apply(NULL, self.value);\n\n\t\t\t\t\t\tif(result && typeof result.then === 'function') {\n\t\t\t\t\t\t\tresult.then(pointer.deferred.resolve, pointer.deferred.reject);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpointer.deferred[self.state === PLEDGE_RESOLVED ? 'resolve' : 'reject'].apply(NULL, self.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlistener[PLEDGE_RESOLVED].length = 0;\n\t\t\t\t\tlistener[PLEDGE_REJECTED].length = 0;\n\t\t\t\t}\n\n\t\t\t\tfunction observe(pledge, index, properties) {\n\t\t\t\t\tpledge.then(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tproperties.resolved[index] = arrayPrototypeSlice.call(arguments);\n\n\t\t\t\t\t\t\tproperties.count++;\n\n\t\t\t\t\t\t\tcheck(properties);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tproperties.rejected.push(arrayPrototypeSlice.call(arguments));\n\n\t\t\t\t\t\t\tcheck(properties);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tfunction check(properties) {\n\t\t\t\t\tif(properties.count === properties.total) {\n\t\t\t\t\t\tproperties.deferred.resolve.apply(NULL, arrayPrototypeConcat.apply([], properties.resolved));\n\t\t\t\t\t} else if(properties.rejected.length + properties.count === properties.total) {\n\t\t\t\t\t\tproperties.deferred.reject.apply(NULL, arrayPrototypeConcat.apply([], properties.rejected));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction Pledge(executor) {\n\t\t\t\t\tvar self = this;\n\n\t\t\t\t\tstorage[Uuid.set(self)] = { handle: handle.bind(self), resolved: [], rejected: [] };\n\n\t\t\t\t\texecutor(resolve.bind(self), reject.bind(self));\n\t\t\t\t}\n\n\t\t\t\tPledge.prototype = {\n\t\t\t\t\t/* only for reference\n\t\t\t\t\t uuid:   NULL,\n\t\t\t\t\t value:  NULL,\n\t\t\t\t\t cache:  NULL, // will only be set by storage\n\t\t\t\t\t */\n\t\t\t\t\tstate:  PLEDGE_PENDING,\n\t\t\t\t\t'catch': function(listener) {\n\t\t\t\t\t\treturn this.then(fn, listener);\n\t\t\t\t\t},\n\t\t\t\t\talways: function(alwaysListener) {\n\t\t\t\t\t\treturn this.then(alwaysListener, alwaysListener);\n\t\t\t\t\t},\n\t\t\t\t\tthen: function(resolveListener, rejectListener) {\n\t\t\t\t\t\tvar self       = this,\n\t\t\t\t\t\t\tproperties = storage[self.uuid],\n\t\t\t\t\t\t\tdeferred   = Pledge.defer();\n\n\t\t\t\t\t\tresolveListener && properties[PLEDGE_RESOLVED].push({ handler: resolveListener, deferred: deferred });\n\t\t\t\t\t\trejectListener && properties[PLEDGE_REJECTED].push({ handler: rejectListener, deferred: deferred });\n\n\t\t\t\t\t\tif(self.state !== PLEDGE_PENDING) {\n\t\t\t\t\t\t\tdefer(properties.handle);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn deferred.pledge;\n\t\t\t\t\t},\n\t\t\t\t\tisPending: function() {\n\t\t\t\t\t\treturn this.state === PLEDGE_PENDING;\n\t\t\t\t\t},\n\t\t\t\t\tisResolved: function() {\n\t\t\t\t\t\treturn this.state === PLEDGE_RESOLVED;\n\t\t\t\t\t},\n\t\t\t\t\tisRejected: function() {\n\t\t\t\t\t\treturn this.state === PLEDGE_REJECTED;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tPledge.defer = function() {\n\t\t\t\t\tvar self = {};\n\n\t\t\t\t\tself.pledge = new Pledge(function(resolveListener, rejectListener) {\n\t\t\t\t\t\tself.resolve = resolveListener;\n\t\t\t\t\t\tself.reject  = rejectListener;\n\t\t\t\t\t});\n\n\t\t\t\t\treturn self;\n\t\t\t\t};\n\n\t\t\t\tPledge.all = function(pledges) {\n\t\t\t\t\tvar deferred   = Pledge.defer(),\n\t\t\t\t\t\tproperties = (storage[Uuid.generate()] = { deferred: deferred, resolved: [], rejected: [], total: pledges.length, count: 0 }),\n\t\t\t\t\t\ti = 0, pledge;\n\n\t\t\t\t\tfor(; pledge = pledges[i]; i++) {\n\t\t\t\t\t\tobserve(pledge, i, properties)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn deferred.pledge;\n\t\t\t\t};\n\n\t\t\t\tPledge.race = function(pledges) {\n\t\t\t\t\tvar deferred = Pledge.defer(),\n\t\t\t\t\t\ti = 0, pledge;\n\n\t\t\t\t\tfor(; pledge = pledges[i]; i++) {\n\t\t\t\t\t\tpledge.then(deferred.resolve, deferred.reject);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn deferred.pledge;\n\t\t\t\t};\n\n\t\t\t\treturn Pledge;\n\t\t\t}());\n\n\t\t/**\n\t\t * Queue\n\t\t */\n\t\t\tQueue = (function() {\n\t\t\t\tvar storage = {};\n\n\t\t\t\tfunction Queue() {\n\t\t\t\t\tUuid.set(this);\n\n\t\t\t\t\tstorage[this.uuid] = [];\n\t\t\t\t}\n\n\t\t\t\tQueue.prototype = {\n\t\t\t\t\t/* only for reference\n\t\t\t\t\t uuid: NULL,\n\t\t\t\t\t */\n\t\t\t\t\tenqueue: function() {\n\t\t\t\t\t\tstorage[this.uuid] = storage[this.uuid].concat(arrayPrototypeSlice.call(arguments));\n\t\t\t\t\t},\n\t\t\t\t\tdequeue: function() {\n\t\t\t\t\t\treturn storage[this.uuid].shift();\n\t\t\t\t\t},\n\t\t\t\t\tget current() {\n\t\t\t\t\t\treturn storage[this.uuid][0];\n\t\t\t\t\t},\n\t\t\t\t\tget length() {\n\t\t\t\t\t\treturn storage[this.uuid].length;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn Queue;\n\t\t\t}());\n\n\t\t/**\n\t\t * QueueHandler\n\t\t */\n\t\t\tQueueHandler = (function() {\n\t\t\t\tvar storage = {};\n\n\t\t\t\tfunction QueueHandler(queue) {\n\t\t\t\t\tUuid.set(this);\n\n\t\t\t\t\tstorage[this.uuid] = { queue: queue, current: NULL };\n\t\t\t\t}\n\n\t\t\t\tQueueHandler.prototype = {\n\t\t\t\t\tprocess: function() {\n\t\t\t\t\t\tvar properties = storage[this.uuid],\n\t\t\t\t\t\t\tqueue      = properties.queue,\n\t\t\t\t\t\t\tcurrent;\n\n\t\t\t\t\t\tif(queue.length) {\n\t\t\t\t\t\t\tcurrent = properties.current = queue.dequeue();\n\n\t\t\t\t\t\t\tcurrent.handler.process.call(current);\n\t\t\t\t\t\t\temit('postProcess', current);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tproperties.current = NULL;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tget current() {\n\t\t\t\t\t\treturn storage[this.uuid].current;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn QueueHandler;\n\t\t\t}());\n\n\t\t/**\n\t\t * Pattern\n\t\t */\n\t\t\tPattern = (function() {\n\t\t\t\tvar regexMatchTrailingSlash = /(.+)\\/$/;\n\n\t\t\t\tfunction Pattern(pattern, url) {\n\t\t\t\t\tvar self = this;\n\n\t\t\t\t\tself.weight       = pattern.length;\n\t\t\t\t\tself.url          = resolveUrl(url).replace(regexMatchTrailingSlash, '$1');\n\t\t\t\t\tself.matchPattern = createRegularExpression('^' + escapeRegularExpression(pattern));\n\t\t\t\t\tself.matchUrl     = createRegularExpression('^' + escapeRegularExpression(url));\n\t\t\t\t}\n\n\t\t\t\tPattern.prototype = {\n\t\t\t\t\t/* only for reference\n\t\t\t\t\t weight:       0,\n\t\t\t\t\t url:          NULL,\n\t\t\t\t\t matchPattern: NULL,\n\t\t\t\t\t matchUrl:     NULL,\n\t\t\t\t\t */\n\t\t\t\t\tmatches: function(path) {\n\t\t\t\t\t\treturn this.matchPattern.test(path);\n\t\t\t\t\t},\n\t\t\t\t\tremove: function(url) {\n\t\t\t\t\t\treturn url.replace(this.matchUrl, '');\n\t\t\t\t\t},\n\t\t\t\t\tprocess: function(path) {\n\t\t\t\t\t\treturn path.replace(this.matchPattern, this.url);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn Pattern;\n\t\t\t}());\n\n\t\t/**\n\t\t * Xhr\n\t\t */\n\t\tXhr = (function(XMLHttpRequest) {\n\t\t\tvar XDomainRequest = 'XDomainRequest' in global && global.XDomainRequest || XMLHttpRequest;\n\n\t\t\tfunction checkState() {\n\t\t\t\tif(this.readyState < 4) {\n\t\t\t\t\tthis.abort();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn function Xhr(url) {\n\t\t\t\tvar boundCheckState = checkState.bind(this),\n\t\t\t\t\tdeferred        = Pledge.defer(),\n\t\t\t\t\txhr             = regexMatchBaseUrl.test(url) ? new XMLHttpRequest() : new XDomainRequest(),\n\t\t\t\t\ttimeout         = settings.timeout,\n\t\t\t\t\tpointer;\n\t\t\t\t\n\t\t\t\txhr.ontimeout = xhr.onerror = xhr.onabort = function() {\n\t\t\t\t\tdeferred.reject(xhr.status);\n\t\t\t\t};\n\t\t\t\txhr.onprogress = xhr.onreadystatechange = function() {\n\t\t\t\t\tclearTimeout(pointer);\n\n\t\t\t\t\tpointer = setTimeout(boundCheckState, settings.timeout);\n\t\t\t\t};\n\t\t\t\txhr.onload = function() {\n\t\t\t\t\ttimeout = clearTimeout(timeout);\n\n\t\t\t\t\tif(!('status' in xhr) || xhr.status === 200) {\n\t\t\t\t\t\tdeferred.resolve(xhr.responseText, xhr.getResponseHeader && xhr.getResponseHeader('content-type'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeferred.reject(xhr.status);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\txhr.open('GET', url, true);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\txhr.send();\n\t\t\t\t});\n\n\t\t\t\tpointer = setTimeout(boundCheckState, settings.timeout);\n\n\t\t\t\treturn deferred.pledge;\n\t\t\t}\n\t\t}(XMLHttpRequest));\n\n\t\t/**\n\t\t * Loader\n\t\t */\n\t\t\tLoader = (function() {\n\t\t\t\tfunction resolveLoader(loader) {\n\t\t\t\t\tvar handler = loader.handler;\n\n\t\t\t\t\temit('preProcess', loader);\n\n\t\t\t\t\thandler.onPreProcess && handler.onPreProcess.call(loader);\n\t\t\t\t\thandler.process && queue.enqueue(loader);\n\n\t\t\t\t\t!queueHandler.current && queueHandler.process();\n\t\t\t\t}\n\n\t\t\t\tfunction Loader(path, parameter) {\n\t\t\t\t\tvar self     = this,\n\t\t\t\t\t\tdeferred = Pledge.defer(),\n\t\t\t\t\t\tpledge   = deferred.pledge,\n\t\t\t\t\t\thandler  = parameter.handler;\n\n\t\t\t\t\tself.deferred = deferred;\n\t\t\t\t\tself.path     = path;\n\t\t\t\t\tself.url      = parameter.url;\n\t\t\t\t\tself.cache    = parameter.cache;\n\t\t\t\t\tself.version  = parameter.version;\n\t\t\t\t\tself.lifetime = parameter.lifetime;\n\n\t\t\t\t\tdemand(MODULE_PREFIX_HANDLER + handler)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\tfunction(handler) {\n\t\t\t\t\t\t\t\tself.handler = handler;\n\t\t\t\t\t\t\t\tself.mock    = parameter.mock ? mocks[self.path] : NULL;\n\n\t\t\t\t\t\t\t\thandler.onPreRequest && handler.onPreRequest.call(self);\n\n\t\t\t\t\t\t\t\tif(!self.mock) {\n\t\t\t\t\t\t\t\t\tif(self.cache === false || !storage.get(self)) {\n\t\t\t\t\t\t\t\t\t\temit('preRequest', self);\n\n\t\t\t\t\t\t\t\t\t\tnew Xhr(self.url).then(\n\t\t\t\t\t\t\t\t\t\t\tfunction(response, type) {\n\t\t\t\t\t\t\t\t\t\t\t\tif(!type || !handler.matchType || handler.matchType.test(type)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tself.source = response;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\temit('postRequest', self);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\thandler.onPostRequest && handler.onPostRequest.call(self);\n\t\t\t\t\t\t\t\t\t\t\t\t\tresolveLoader(self);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(self.cache !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpledge.then(function() { storage.set(self); });\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeferred.reject(new Failure('error loading (content-type)', self.path));\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tfunction(status) {\n\t\t\t\t\t\t\t\t\t\t\t\tdeferred.reject(new Failure('error loading' + (status ? ' (status)' : ''), self.path));\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tresolveLoader(self);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif(self.mock.dependencies) {\n\t\t\t\t\t\t\t\t\t\tself.mock.dependencies.then(\n\t\t\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t\t\tself.mock.resolve(self);\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tself.mock.reject\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tself.mock.resolve(self);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdeferred.reject\n\t\t\t\t\t\t);\n\n\t\t\t\t\treturn deferred;\n\t\t\t\t}\n\n\t\t\t\t/* only for reference\n\t\t\t\t Loader.prototype = {\n\t\t\t\t\t deferred: NULL,\n\t\t\t\t\t path:     NULL,\n\t\t\t\t\t url:      NULL,\n\t\t\t\t\t handler:  NULL,\n\t\t\t\t\t source:   NULL,\n\t\t\t\t\t mock:     NULL,\n\t\t\t\t\t cache:    NULL,\n\t\t\t\t\t lifetime: NULL,\n\t\t\t\t\t version:  NULL,\n\t\t\t\t\t storage:  NULL, // will only be set by storage\n\t\t\t\t\t state:    { version: NULL, expires: NULL, url: NULL } // will only be set by storage\n\t\t\t\t };\n\t\t\t\t */\n\n\t\t\t\treturn Loader;\n\t\t\t}());\n\n\t\t/**\n\t\t * Failure\n\t\t */\n\t\t\tFailure = (function() {\n\t\t\t\tfunction Failure(message, module, stack) {\n\t\t\t\t\tthis.message = message;\n\n\t\t\t\t\tmodule && (this.module = module);\n\t\t\t\t\tstack && (this.stack = arrayPrototypeSlice.call(stack));\n\t\t\t\t}\n\n\t\t\t\tFailure.prototype = {\n\t\t\t\t\t/* only for reference\n\t\t\t\t\t message: NULL,\n\t\t\t\t\t module:  NULL,\n\t\t\t\t\t stack:   NULL,\n\t\t\t\t\t */\n\t\t\t\t\ttoString: function() {\n\t\t\t\t\t\tvar self   = this,\n\t\t\t\t\t\t\tresult = DEMAND_ID + ': ' + self.message + ' ' + (self.module ? '\"' + self.module + '\"' : '');\n\n\t\t\t\t\t\tif(self.stack) {\n\t\t\t\t\t\t\tresult = Failure.traverse(self.stack, result, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tFailure.traverse = function(stack, value, depth) {\n\t\t\t\t\tvar indention = new Array(depth + 1).join(' '),\n\t\t\t\t\t\ti = 0, item;\n\n\t\t\t\t\tfor(; item = stack[i]; i++) {\n\t\t\t\t\t\tvalue += '\\n' + indention + '> ' + item.message + ' ' + (item.module ? '\"' + item.module + '\"' : '');\n\n\t\t\t\t\t\tif(item.stack) {\n\t\t\t\t\t\t\tvalue = Failure.traverse(item.stack, value, depth + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn value;\n\t\t\t\t};\n\n\t\t\t\treturn Failure;\n\t\t\t}());\n\t\n\t/**\n\t * --------------------------------\n\t * Demand\n\t * --------------------------------\n\t */\n\t\tfunction demand() {\n\t\t\tvar dependencies = arrayPrototypeSlice.call(arguments),\n\t\t\t\tcontext      = this !== window ? this : NULL,\n\t\t\t\ti = 0, dependency;\n\t\t\t\n\t\t\temit('preResolve', dependencies, context);\n\n\t\t\tfor(; (dependency = dependencies[i]); i++) {\n\t\t\t\tdependencies[i] = resolveDependency(dependency, context);\n\t\t\t}\n\t\t\t\n\t\t\temit('postResolve', dependencies, context);\n\n\t\t\treturn Pledge.all(dependencies);\n\t\t}\n\t\t\n\t\tdemand.configure = function(parameter) {\n\t\t\tvar cache    = parameter.cache,\n\t\t\t\tversion  = parameter.version,\n\t\t\t\ttimeout  = parameter.timeout,\n\t\t\t\tlifetime = parameter.lifetime,\n\t\t\t\tbase     = parameter.base,\n\t\t\t\tpattern  = parameter.pattern,\n\t\t\t\tmodules  = parameter.modules,\n\t\t\t\tpointer  = settings.modules,\n\t\t\t\ttemp;\n\t\t\t\n\t\t\tif(isTypeOf(cache, STRING_BOOLEAN)) {\n\t\t\t\tsettings.cache[''] = { weight: 0, state: cache };\n\t\t\t} else if(isObject(cache)) {\n\t\t\t\titerate(cache, function(property, value) {\n\t\t\t\t\tsettings.cache[property] = { weight: property.length, state: value };\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif(isTypeOf(version, STRING_STRING)) {\n\t\t\t\tsettings.version = version;\n\t\t\t}\n\t\t\t\n\t\t\tif(isPositiveInteger(timeout)) {\n\t\t\t\tsettings.timeout = Math.min(Math.max(timeout, 2), 12) * 1000;\n\t\t\t}\n\t\t\t\n\t\t\tif(isPositiveInteger(lifetime) && lifetime > 0) {\n\t\t\t\tsettings.lifetime = lifetime * 1000;\n\t\t\t}\n\t\t\t\n\t\t\tif(isTypeOf(base, STRING_STRING) && base !== '') {\n\t\t\t\tsettings.pattern.base = new Pattern('', base);\n\t\t\t}\n\t\t\t\n\t\t\tif(isObject(pattern)) {\n\t\t\t\titerate(pattern, function(property, value) {\n\t\t\t\t\tproperty !== 'base' && (settings.pattern[property] = new Pattern(property, value));\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif(isObject(modules)) {\n\t\t\t\titerate(modules, function(property, value) {\n\t\t\t\t\tif(property !== MODULE_PREFIX_STORAGE) {\n\t\t\t\t\t\ttemp = pointer[property] = pointer[property] || {};\n\n\t\t\t\t\t\temit('preConfigure:' + property, temp);\n\n\t\t\t\t\t\tmerge(temp, value);\n\n\t\t\t\t\t\temit('postConfigure:' + property, temp);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\treturn demand;\n\t\t};\n\t\t\n\t\tdemand.remove = function(path) {\n\t\t\tif(registry[path]) {\n\t\t\t\t!!registry[path].cache && storage.clean.path(path);\n\t\t\t\t\n\t\t\t\tdelete registry[path];\n\t\t\t\tdelete mocks[path];\n\t\t\t}\n\t\t\t\n\t\t\treturn demand;\n\t\t};\n\t\t\n\t\tdemand.on = function(events, callback) {\n\t\t\tvar event, pointer;\n\t\t\t\n\t\t\tif(isTypeOf(events, STRING_STRING) && isTypeOf(callback, STRING_FUNCTION)) {\n\t\t\t\tevents = events.split(' ');\n\t\t\t\t\n\t\t\t\twhile(event = events.shift()) {\n\t\t\t\t\tif(regexMatchEvent.test(event)) {\n\t\t\t\t\t\t(listener[event] || (listener[event] = [])).push(callback);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(event.indexOf('postConfigure:') === 0) {\n\t\t\t\t\t\t\tpointer = settings.modules[event.substr(14)];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(pointer !== undefined) {\n\t\t\t\t\t\t\t\tcallback(pointer);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn demand;\n\t\t};\n\t\t\n\t\tdemand.list = function(state) {\n\t\t\tvar keys, pledge;\n\t\t\t\n\t\t\tif(state) {\n\t\t\t\tkeys = [];\n\n\t\t\t\titerate(registry, function(property, value) {\n\t\t\t\t\tpledge = value.pledge;\n\n\t\t\t\t\tif(pledge.state === state || pledge.cache === state) {\n\t\t\t\t\t\tkeys.push(property);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tkeys = Object.keys(registry);\n\t\t\t}\n\t\t\t\n\t\t\treturn keys;\n\t\t};\n\n\t/**\n\t * --------------------------------\n\t * Provide\n\t * --------------------------------\n\t */\n\t\tfunction provide() {\n\t\t\tvar parameter    = arguments,\n\t\t\t\tpath         = isTypeOf(parameter[0], STRING_STRING) ? parameter[0] : NULL,\n\t\t\t\tdependencies = isArray(parameter[path ? 1 : 0]) ? parameter[path ? 1 : 0] : NULL,\n\t\t\t\tdefinition   = dependencies ? parameter[path ? 2 : 1] : parameter[path ? 1 : 0],\n\t\t\t\tdeferred, pledge, isFunction;\n\n\t\t\tif(!path && queueHandler.current) {\n\t\t\t\tpath = queueHandler.current.path;\n\n\t\t\t\tqueueHandler.process();\n\t\t\t}\n\n\t\t\tif(path) {\n\t\t\t\tpath       = resolvePath(path, this);\n\t\t\t\tdeferred   = registry[path] || (registry[path] = Pledge.defer());\n\t\t\t\tpledge     = deferred.pledge;\n\t\t\t\tisFunction = isTypeOf(definition, STRING_FUNCTION);\n\n\t\t\t\tif(pledge.isPending()) {\n\t\t\t\t\tif(dependencies) {\n\t\t\t\t\t\tdemand\n\t\t\t\t\t\t\t.apply(path, dependencies)\n\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\tfunction() { deferred.resolve(isFunction ? definition.apply(NULL, arguments) : definition); },\n\t\t\t\t\t\t\t\tfunction() { log(new Failure('error providing', path)); }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeferred.resolve(isFunction ? definition() : definition);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow new Failure('unspecified anonymous provide');\n\t\t\t}\n\t\t}\n\t\n\t/**\n\t * --------------------------------\n\t * Modules\n\t * --------------------------------\n\t */\n\t\t/**\n\t\t * /demand/storage\n\t\t */\n\t\t\t(function(){\n\t\t\t\tfunction definition() {\n\t\t\t\t\tvar STORAGE_PREFIX       = '[' + DEMAND_ID + ']',\n\t\t\t\t\t\tSTORAGE_SUFFIX_STATE = '[state]',\n\t\t\t\t\t\tSTORAGE_SUFFIX_VALUE = '[value]',\n\t\t\t\t\t\tregexMatchState      = createRegularExpression('^' + escapeRegularExpression(STORAGE_PREFIX) + '\\\\[(.+?)\\\\]' + escapeRegularExpression(STORAGE_SUFFIX_STATE) + '$'),\n\t\t\t\t\t\tlocalStorage         = (function() { try { return 'localStorage' in global && global.localStorage; } catch(exception) { return false; } }()),\n\t\t\t\t\t\thasRemainingSpace    = localStorage && 'remainingSpace' in localStorage;\n\n\t\t\t\t\tfunction isEnabled(loader) {\n\t\t\t\t\t\tvar match;\n\n\t\t\t\t\t\tif(loader.cache !== NULL) {\n\t\t\t\t\t\t\treturn loader.cache;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\titerate(settings.cache, function(property, value) {\n\t\t\t\t\t\t\tif(loader.path.indexOf(property) === 0 && (!match || value.weight > match.weight)) {\n\t\t\t\t\t\t\t\tmatch = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn match ? match.state : false;\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction Storage() {\n\t\t\t\t\t\tthis.clear.expired();\n\t\t\t\t\t}\n\n\t\t\t\t\tStorage.prototype = {\n\t\t\t\t\t\texists: function(loader) {\n\t\t\t\t\t\t\tvar path = loader.path,\n\t\t\t\t\t\t\t\tstate;\n\n\t\t\t\t\t\t\tloader.storage = STORAGE_PREFIX + '[' + path + ']';\n\n\t\t\t\t\t\t\tif(localStorage && isEnabled(loader)) {\n\t\t\t\t\t\t\t\tstate  = JSON.parse(localStorage.getItem(loader.storage + STORAGE_SUFFIX_STATE));\n\n\t\t\t\t\t\t\t\tif(state && state.version === loader.version && state.url === loader.url && ((!state.expires && !loader.lifetime) || state.expires > getTimestamp())) {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.clear.path(path);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tget: function(loader) {\n\t\t\t\t\t\t\tvar pledge = loader.deferred.pledge;\n\n\t\t\t\t\t\t\tif(this.exists(loader)) {\n\t\t\t\t\t\t\t\tpledge.cache  = 'hit';\n\t\t\t\t\t\t\t\tloader.source = localStorage.getItem(loader.storage + STORAGE_SUFFIX_VALUE);\n\n\t\t\t\t\t\t\t\temit('cacheHit', loader);\n\n\t\t\t\t\t\t\t\treturn loader.source;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpledge.cache = 'miss';\n\n\t\t\t\t\t\t\t\temit('cacheMiss', loader);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tset: function(loader) {\n\t\t\t\t\t\t\tvar path = loader.path,\n\t\t\t\t\t\t\t\tlifetime, id, spaceBefore;\n\n\t\t\t\t\t\t\tif(localStorage && isEnabled(loader)) {\n\t\t\t\t\t\t\t\temit('preCache', loader);\n\n\t\t\t\t\t\t\t\tlifetime = loader.lifetime;\n\t\t\t\t\t\t\t\tid       = STORAGE_PREFIX + '[' + path + ']';\n\n\t\t\t\t\t\t\t\tloader.state = { version: loader.version, expires: lifetime ? getTimestamp() + lifetime : lifetime, url: loader.url };\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tspaceBefore = hasRemainingSpace ? localStorage.remainingSpace : NULL;\n\n\t\t\t\t\t\t\t\t\tlocalStorage.setItem(id + STORAGE_SUFFIX_VALUE, loader.source);\n\t\t\t\t\t\t\t\t\tlocalStorage.setItem(id + STORAGE_SUFFIX_STATE, JSON.stringify(loader.state));\n\n\t\t\t\t\t\t\t\t\t// strict equality check with \"===\" is required due to spaceBefore might be \"0\"\n\t\t\t\t\t\t\t\t\tif(spaceBefore !== NULL && localStorage.remainingSpace === spaceBefore) {\n\t\t\t\t\t\t\t\t\t\tthrow new Error('QUOTA_EXCEEDED_ERR');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\temit('postCache', loader);\n\t\t\t\t\t\t\t\t} catch(error) {\n\t\t\t\t\t\t\t\t\temit('cacheExceed', loader);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclear: {\n\t\t\t\t\t\t\tpath: function(path) {\n\t\t\t\t\t\t\t\tvar id;\n\n\t\t\t\t\t\t\t\tif(localStorage) {\n\t\t\t\t\t\t\t\t\tid = STORAGE_PREFIX + '[' + path + ']';\n\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem(id + STORAGE_SUFFIX_STATE);\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem(id + STORAGE_SUFFIX_VALUE);\n\n\t\t\t\t\t\t\t\t\temit('cacheClear', path);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tall: function() {\n\t\t\t\t\t\t\t\tvar match;\n\n\t\t\t\t\t\t\t\tif(localStorage) {\n\t\t\t\t\t\t\t\t\titerate(localStorage, function(property) {\n\t\t\t\t\t\t\t\t\t\tmatch = property.match(regexMatchState);\n\n\t\t\t\t\t\t\t\t\t\tmatch && this.path(match[1]);\n\t\t\t\t\t\t\t\t\t}, this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\texpired: function() {\n\t\t\t\t\t\t\t\tvar match, state;\n\n\t\t\t\t\t\t\t\tif(localStorage) {\n\t\t\t\t\t\t\t\t\titerate(localStorage, function(property) {\n\t\t\t\t\t\t\t\t\t\tmatch = property.match(regexMatchState);\n\n\t\t\t\t\t\t\t\t\t\tif(match) {\n\t\t\t\t\t\t\t\t\t\t\tstate = JSON.parse(localStorage.getItem(STORAGE_PREFIX + '[' + match[1] + ']' + STORAGE_SUFFIX_STATE));\n\n\t\t\t\t\t\t\t\t\t\t\tif(state && state.expires > 0 && state.expires <= getTimestamp()) {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.path(match[1]);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tdemand.clear = (storage = new Storage()).clear;\n\n\t\t\t\t\treturn storage;\n\t\t\t\t}\n\n\t\t\t\tprovide(MODULE_PREFIX_STORAGE, definition);\n\t\t\t}());\n\n\t\t/**\n\t\t * /demand/handler/module\n\t\t */\n\t\t\t(function() {\n\t\t\t\tfunction definition() {\n\t\t\t\t\tvar target = document.getElementsByTagName('head')[0];\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmatchType: /^(application|text)\\/(x-)?javascript/,\n\t\t\t\t\t\tonPreRequest: function() {\n\t\t\t\t\t\t\tvar url  = this.url;\n\n\t\t\t\t\t\t\tthis.url = url.slice(-3) !== '.js' ? url + '.js' : url;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPostRequest: function() {\n\t\t\t\t\t\t\tvar self   = this,\n\t\t\t\t\t\t\t\tsource = self.source,\n\t\t\t\t\t\t\t\tmatch, replacement;\n\n\t\t\t\t\t\t\tif(source) {\n\t\t\t\t\t\t\t\twhile(match = regexMatchSourcemap.exec(source)) {\n\t\t\t\t\t\t\t\t\tif(regexIsAbsolutePath.test(match[1])) {\n\t\t\t\t\t\t\t\t\t\tresolver.href = self.url;\n\n\t\t\t\t\t\t\t\t\t\treplacement = resolver.protocol + '//' + resolver.host + match[1];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treplacement = resolveUrl(self.url + '/../' + match[1]);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tsource = source.replace(match[0], '//# sourceMappingURL=' + replacement + '.map');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tself.source = source;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprocess: function() {\n\t\t\t\t\t\t\tvar source = this.source,\n\t\t\t\t\t\t\t\tscript;\n\n\t\t\t\t\t\t\tif(source) {\n\t\t\t\t\t\t\t\tscript       = document.createElement('script');\n\t\t\t\t\t\t\t\tscript.async = true;\n\t\t\t\t\t\t\t\tscript.text  = source;\n\n\t\t\t\t\t\t\t\tscript.setAttribute('demand-path', this.path);\n\n\t\t\t\t\t\t\t\ttarget.appendChild(script);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tprovide(MODULE_PREFIX_HANDLER + 'module', definition);\n\t\t\t}());\n\n\t\t/**\n\t\t * /demand/handler/bundle\n\t\t */\n\t\t\t(function() {\n\t\t\t\tvar path = MODULE_PREFIX_HANDLER + 'bundle',\n\t\t\t\t\tsettings;\n\n\t\t\t\tfunction definition(handlerModule) {\n\t\t\t\t\tdemand.on('postConfigure:' + path, function(options) {\n\t\t\t\t\t\tsettings = isObject(options) ? options : {};\n\t\t\t\t\t});\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmatchType:     handlerModule.matchType,\n\t\t\t\t\t\tonPostRequest: function() {\n\t\t\t\t\t\t\tvar self   = this,\n\t\t\t\t\t\t\t\tsource = self.source,\n\t\t\t\t\t\t\t\tmatch;\n\n\t\t\t\t\t\t\tif(source) {\n\t\t\t\t\t\t\t\twhile(match = regexMatchSourcemap.exec(source)) {\n\t\t\t\t\t\t\t\t\tsource = source.replace(match[0], '');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tself.source = source;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPreProcess: function() {\n\t\t\t\t\t\t\tvar self     = this,\n\t\t\t\t\t\t\t\tdeferred = self.deferred,\n\t\t\t\t\t\t\t\tmodules  = settings[self.path];\n\n\t\t\t\t\t\t\tmock.apply(NULL, modules)\n\t\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\tqueue.enqueue.apply(queue, arguments);\n\t\t\t\t\t\t\t\t\t\tqueueHandler.process();\n\t\t\t\t\t\t\t\t\t\thandlerModule.process.call(self);\n\n\t\t\t\t\t\t\t\t\t\tdemand\n\t\t\t\t\t\t\t\t\t\t\t.apply(NULL, modules)\n\t\t\t\t\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\t\t\t\t\tdeferred.resolve,\n\t\t\t\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeferred.reject(new Failure('error resolving', self.path, arguments));\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\tdeferred.reject(new Failure('error mocking', NULL, arguments));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tprovide(path, [ '/demand/handler/module' ], definition);\n\t\t\t}());\n\n\t\t/**\n\t\t * /demand/plugin/genie\n\t\t */\n\t\t\t(function() {\n\t\t\t\tvar path = MODULE_PREFIX_PLUGIN + 'genie';\n\n\t\t\t\tfunction definition() {\n\t\t\t\t\tvar pattern = [];\n\n\t\t\t\t\tfunction matchPattern(path) {\n\t\t\t\t\t\tvar i = 0, pointer, match;\n\n\t\t\t\t\t\tfor(; (pointer = pattern[i]); i++) {\n\t\t\t\t\t\t\tif(path.indexOf(pointer.prefix) === 0 && (!match || pointer.weight > match.weight)) {\n\t\t\t\t\t\t\t\tmatch = pointer;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn match;\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction generateConfiguration(bundle) {\n\t\t\t\t\t\tvar matches       = bundle.matches,\n\t\t\t\t\t\t\tconfiguration = { pattern: {}, modules: { '/demand/handler/bundle': {} } },\n\t\t\t\t\t\t\ti = 0, pointer, dependency;\n\n\t\t\t\t\t\tconfiguration.pattern[bundle.id]                           = bundle.fn(matches);\n\t\t\t\t\t\tconfiguration.modules['/demand/handler/bundle'][bundle.id] = pointer = [];\n\n\t\t\t\t\t\tfor(; (dependency = matches[i]); i++) {\n\t\t\t\t\t\t\tpointer.push(dependency.path);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn configuration;\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction getModule(path) {\n\t\t\t\t\t\treturn (registry[path] && registry[path].pledge) || (mocks[path] && mocks[path].pledge);\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction resolveDependencies() {\n\t\t\t\t\t\tvar i = 0, dependency;\n\n\t\t\t\t\t\tfor(; (dependency = this[i]); i++) {\n\t\t\t\t\t\t\tdependency.deferred.resolve(arguments[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction rejectDependencies() {\n\t\t\t\t\t\tvar i = 0, dependency;\n\n\t\t\t\t\t\tfor(; (dependency = this[i]); i++) {\n\t\t\t\t\t\t\tdependency.deferred.reject(new Failure('error resolving', dependency.path));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tdemand\n\t\t\t\t\t\t.on('postConfigure:' + path, function(options) {\n\t\t\t\t\t\t\tif(isObject(options)) {\n\t\t\t\t\t\t\t\tpattern.length = 0;\n\n\t\t\t\t\t\t\t\titerate(options, function(property, value) {\n\t\t\t\t\t\t\t\t\tpattern.push({ prefix: property, weight: property.length, fn: value });\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.on('preResolve', function(dependencies, context) {\n\t\t\t\t\t\t\tvar bundles = {},\n\t\t\t\t\t\t\t\ti, dependency, path, parameter, pattern, matches;\n\n\t\t\t\t\t\t\tfor(i = 0; (dependency = dependencies[i]); i++) {\n\t\t\t\t\t\t\t\tif(isTypeOf(dependency, STRING_STRING) && !regexMatchInternal.test(dependency)) {\n\t\t\t\t\t\t\t\t\tpath      = resolvePath(dependency, context);\n\t\t\t\t\t\t\t\t\tparameter = resolveParameter(dependency, context);\n\n\t\t\t\t\t\t\t\t\tparameter.path = path;\n\t\t\t\t\t\t\t\t\tparameter.url  = parameter.url.slice(-3) !== '.js' ? parameter.url + '.js' : parameter.url;\n\n\t\t\t\t\t\t\t\t\tif((pattern = matchPattern(path)) && parameter.handler === 'module' && !getModule(path) && !storage.exists(parameter)) {\n\t\t\t\t\t\t\t\t\t\t(bundles[pattern.prefix] || (bundles[pattern.prefix] = { fn: pattern.fn, matches: [] })).matches.push({ path: path, index: i });\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\titerate(bundles, function(property, value) {\n\t\t\t\t\t\t\t\tmatches = value.matches;\n\n\t\t\t\t\t\t\t\tif(matches.length > 1) {\n\t\t\t\t\t\t\t\t\tvalue.id = '/genie/' + hash(JSON.stringify(value.matches));\n\n\t\t\t\t\t\t\t\t\tfor(i = 0; (dependency = matches[i]); i++) {\n\t\t\t\t\t\t\t\t\t\tdependency.deferred            = Pledge.defer();\n\t\t\t\t\t\t\t\t\t\tdependencies[dependency.index] = dependency.deferred.pledge;\n\n\t\t\t\t\t\t\t\t\t\tmock(dependency.id);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tdemand.configure(generateConfiguration(value));\n\t\t\t\t\t\t\t\t\tdemand('bundle!' + value.id)\n\t\t\t\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\t\t\t\tresolveDependencies.bind(matches),\n\t\t\t\t\t\t\t\t\t\t\trejectDependencies.bind(matches)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tprovide(path, definition);\n\t\t\t}());\n\t\n\t/**\n\t * --------------------------------\n\t * Initialization\n\t * --------------------------------\n\t */\n\t\t(function() {\n\t\t\tfunction assignModule(id, factory) {\n\t\t\t\tprovide(id, function() { return factory; });\n\t\t\t}\n\n\t\t\tregexMatchBaseUrl = createRegularExpression('^' + escapeRegularExpression(resolveUrl('/')));\n\n\t\t\tdemand.configure({ cache: true, base: '/', pattern: { '/demand': resolveUrl(((configuration && configuration.url) || location.href) + '/../').slice(0, -1)} });\n\t\t\tconfiguration && configuration.settings && demand.configure(configuration.settings);\n\n\t\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isArray', isArray);\n\t\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isObject', isObject);\n\t\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isTypeOf', isTypeOf);\n\t\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isInstanceOf', isInstanceOf);\n\t\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isPositiveInteger', isPositiveInteger);\n\t\t\tassignModule(MODULE_PREFIX_FUNCTION + 'merge', merge);\n\t\t\tassignModule(MODULE_PREFIX_FUNCTION + 'iterate', iterate);\n\t\t\tassignModule(MODULE_PREFIX_FUNCTION + 'hash', hash);\n\t\t\tassignModule(MODULE_PREFIX_FUNCTION + 'defer', defer);\n\t\t\tassignModule(MODULE_PREFIX + 'uuid', Uuid);\n\t\t\tassignModule(MODULE_PREFIX + 'pledge', Pledge);\n\t\t\tassignModule(MODULE_PREFIX + 'queue', Queue);\n\t\t\tassignModule(MODULE_PREFIX + 'xhr', Xhr);\n\t\t\tassignModule(MODULE_PREFIX + 'failure', Failure);\n\n\t\t\tqueue        = new Queue();\n\t\t\tqueueHandler = new QueueHandler(queue);\n\n\t\t\tglobal.demand  = demand;\n\t\t\tglobal.provide = provide;\n\n\t\t\tif(configuration && configuration.main) {\n\t\t\t\tdemand(configuration.main);\n\t\t\t}\n\t\t}());\n}(this, document, 'demand' in this && demand, JSON, Array.prototype, Object.prototype, setTimeout));"]}