{"version":3,"sources":["demand.js"],"names":["global","document","configuration","JSON","XHR","arrayPrototype","objectPrototype","undefined","emit","event","parameter","i","callback","pointer","listener","arrayPrototypeSlice","call","arguments","apply","NULL","log","error","isTypeOf","console","toString","assignModule","id","factory","provide","escapeRegularExpression","value","replace","regexMatchRegex","createRegularExpression","expression","modifier","RegExp","getTimestamp","Date","resolveUrl","url","resolver","href","resolvePath","path","context","regexMatchParameter","regexIsAbsolutePath","test","regexIsAbsoluteUri","regexMatchBaseUrl","resolveDependency","dependency","definition","deferred","STRING_STRING","DEMAND_ID","PROVIDE_ID","PATH_ID","MODULE_PREFIX_LOCAL","scopedDemand","demand","bind","iterate","property","MODULE_PREFIX_PATHS","registry","Loader","resolveParameter","pledge","isInstanceOf","Pledge","defer","resolve","match","pattern","settings","matches","weight","mock","cache","handler","version","lifetime","process","resolveLoader","loader","isPending","onPreProcess","queue","enqueue","currentQueueItem","processQueue","mergeProperties","targetPropertyIsObject","targetProperty","this","isObject","length","merge","isArray","objectPrototypeToString","object","type","module","isPositiveInteger","isFinite","Math","floor","properties","target","Object","keys","dequeue","dependencies","window","all","isFunction","Failure","STRING_FUNCTION","then","storage","slice","arrayPrototypeConcat","concat","MODULE_PREFIX","MODULE_PREFIX_STORAGE","MODULE_PREFIX_HANDLER","MODULE_PREFIX_PLUGIN","MODULE_PREFIX_FUNCTION","MODULE_PREFIX_VALIDATOR","STRING_BOOLEAN","XDR","XDomainRequest","regexMatchTrailingSlash","regexMatchEvent","timeout","modules","createElement","mocks","Uuid","element","fallback","hasSetImmediate","fn","MutationObserver","observe","attributes","setAttribute","onMessage","source","regex","exec","data","prefix","addEventListener","uuid","generate","postMessage","onreadystatechange","parentNode","removeChild","body","appendChild","setImmediate","setTimeout","randomize","character","r","random","objectDefineProperty","defineProperty","prototype","result","set","__proto__","enumerable","configurable","writable","handle","PLEDGE_RESOLVED","reject","PLEDGE_REJECTED","state","self","PLEDGE_PENDING","shift","index","resolved","count","check","rejected","push","total","executor","always","alwaysListener","resolveListener","rejectListener","isResolved","isRejected","pledges","race","Queue","current","Pattern","matchPattern","matchUrl","remove","xhr","onPreRequest","get","onprogress","ontimeout","onerror","onabort","onload","getResponseHeader","clearTimeout","status","matchType","responseText","onPostRequest","open","send","readyState","abort","message","stack","traverse","depth","item","indention","Array","join","configure","temp","base","min","max","clean","on","events","split","indexOf","substr","list","isEnabled","Storage","clear","expired","STORAGE_PREFIX","STORAGE_SUFFIX_STATE","STORAGE_SUFFIX_VALUE","regexMatchState","localStorage","exception","hasRemainingSpace","parse","getItem","expires","spaceBefore","remainingSpace","setItem","stringify","Error","removeItem","getElementsByTagName","regexMatchSourcemap","replacement","protocol","host","script","async","text","handlerModule","onPostConfigure","options","generateHash","hash","charCodeAt","generateConfiguration","bundle","/demand/handler/bundle","getModule","resolveDependencies","dfd","rejectDependencies","bundles","mockModules","/demand","location","main","XMLHttpRequest"],"mappings":"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","file":"demand.js","sourcesContent":["/**\n * Qoopido demand\n *\n * Promise like module loader (XHR) with localStorage caching\n *\n * Copyright (c) 2016 Dirk Lueth\n *\n * Dual licensed under the MIT and GPL licenses.\n *  - http://www.opensource.org/licenses/mit-license.php\n *  - http://www.gnu.org/copyleft/gpl.html\n *\n * @author Dirk Lueth <info@qoopido.com>\n */\n\n/* global demand */\n\n(function(global, document, configuration, JSON, XHR, arrayPrototype, objectPrototype, undefined) {\n\t'use strict';\n\t\n\tvar /** pointer */\n\t\t\tarrayPrototypeSlice     = arrayPrototype.slice,\n\t\t\tobjectPrototypeToString = objectPrototype.toString,\n\t\t\tarrayPrototypeConcat    = arrayPrototype.concat,\n\t\t/** constants */\n\t\t\tDEMAND_ID               = 'demand',\n\t\t\tPROVIDE_ID              = 'provide',\n\t\t\tPATH_ID                 = 'path',\n\t\t\tMODULE_PREFIX           = '/' + DEMAND_ID + '/',\n\t\t\tMODULE_PREFIX_STORAGE   = MODULE_PREFIX + 'storage/',\n\t\t\tMODULE_PREFIX_HANDLER   = MODULE_PREFIX + 'handler/',\n\t\t\tMODULE_PREFIX_PLUGIN    = MODULE_PREFIX + 'plugin/',\n\t\t\tMODULE_PREFIX_LOCAL     = MODULE_PREFIX + 'local',\n\t\t\tMODULE_PREFIX_PATHS     = MODULE_PREFIX + 'paths',\n\t\t\tMODULE_PREFIX_FUNCTION  = MODULE_PREFIX + 'function/',\n\t\t\tMODULE_PREFIX_VALIDATOR = MODULE_PREFIX + 'validator/',\n\t\t\tSTRING_STRING           = 'string',\n\t\t\tSTRING_BOOLEAN          = 'boolean',\n\t\t\tSTRING_FUNCTION         = 'function',\n\t\t\tNULL                    = null,\n\t\t\tXDR                     = 'XDomainRequest' in global &&  global.XDomainRequest || XHR,\n\t\t/** regular expressions */\n\t\t\tregexIsAbsolutePath     = /^\\//,\n\t\t\tregexIsAbsoluteUri      = /^(http(s?):)?\\/\\//i,\n\t\t\tregexMatchTrailingSlash = /(.+)\\/$/,\n\t\t\tregexMatchParameter     = /^(mock:)?([+-])?((?:[-\\w]+\\/?)+)?(?:@(\\d+\\.\\d+.\\d+))?(?:#(\\d+))?!/,\n\t\t\tregexMatchRegex         = /[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g,\n\t\t\tregexMatchEvent         = /^cache(Miss|Hit|Clear|Exceed)|(pre|post)(Configure.*|Resolve|Request|Process|Cache)$/,\n\t\t/** other */\n\t\t\tsettings                = { cache: {}, timeout: 8 * 1000, pattern: {}, modules: {}, handler: 'module' },\n\t\t\tresolver                = document.createElement('a'),\n\t\t\tregistry                = {},\n\t\t\tlistener                = {},\n\t\t\tmocks                   = {},\n\t\t\tregexMatchBaseUrl, queue, storage;\n\n\t/**\n\t * --------------------------------\n\t * Functions\n\t * --------------------------------\n\t */\n\t\tfunction emit(event) {\n\t\t\tvar pointer = listener[event],\n\t\t\t\tparameter, i, callback;\n\t\t\t\n\t\t\tif(pointer) {\n\t\t\t\tparameter = arrayPrototypeSlice.call(arguments, 1);\n\t\t\t\t\n\t\t\t\tfor(i = 0; (callback = pointer[i]); i++) {\n\t\t\t\t\tcallback.apply(NULL, parameter);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction log(error) {\n\t\t\t/* eslint-disable no-console */\n\t\t\tif(!isTypeOf(console, 'undefined')) {\n\t\t\t\tconsole.error(error.toString());\n\t\t\t}\n\t\t\t/* eslint-enable no-console */\n\t\t}\n\t\t\n\t\tfunction assignModule(id, factory) {\n\t\t\tprovide(id, function() { return factory; });\n\t\t}\n\t\t\n\t\tfunction escapeRegularExpression(value) {\n\t\t\treturn value.replace(regexMatchRegex, '\\\\$&');\n\t\t}\n\t\t\n\t\tfunction createRegularExpression(expression, modifier) {\n\t\t\treturn new RegExp(expression, modifier);\n\t\t}\n\t\t\n\t\tfunction getTimestamp() {\n\t\t\treturn +new Date();\n\t\t}\n\t\t\n\t\tfunction resolveUrl(url) {\n\t\t\tresolver.href = url;\n\t\t\t\n\t\t\treturn resolver.href;\n\t\t}\n\t\t\n\t\tfunction resolvePath(path, context) {\n\t\t\tpath = path.replace(regexMatchParameter, '');\n\t\t\t\n\t\t\tif(!regexIsAbsolutePath.test(path) && !regexIsAbsoluteUri.test(path)) {\n\t\t\t\tpath = '/' + resolveUrl(((context && resolveUrl(context + '/../')) || '/') + path).replace(regexMatchBaseUrl, '');\n\t\t\t}\n\t\t\t\n\t\t\treturn path;\n\t\t}\n\t\t\n\t\tfunction resolveDependency(dependency, context) {\n\t\t\tvar path, definition, deferred;\n\t\t\t\n\t\t\tif(isTypeOf(dependency, STRING_STRING)) {\n\t\t\t\tpath = resolvePath(dependency, context);\n\t\t\t\t\n\t\t\t\tif(context && (dependency === DEMAND_ID || dependency === PROVIDE_ID || dependency === PATH_ID)) {\n\t\t\t\t\tswitch(dependency) {\n\t\t\t\t\t\tcase DEMAND_ID:\n\t\t\t\t\t\t\tpath       = MODULE_PREFIX_LOCAL + path;\n\t\t\t\t\t\t\tdefinition = function() {\n\t\t\t\t\t\t\t\tvar scopedDemand = demand.bind(context);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\titerate(demand, function(property, value) {\n\t\t\t\t\t\t\t\t\tscopedDemand[property] = value;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\treturn scopedDemand;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase PROVIDE_ID:\n\t\t\t\t\t\t\tpath       = MODULE_PREFIX_LOCAL + path;\n\t\t\t\t\t\t\tdefinition = function() {\n\t\t\t\t\t\t\t\treturn provide.bind(context);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase PATH_ID:\n\t\t\t\t\t\t\tpath       = MODULE_PREFIX_PATHS + context;\n\t\t\t\t\t\t\tdefinition = function() {\n\t\t\t\t\t\t\t\treturn context;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t!registry[path] && provide(path, definition);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn (registry[path] || (registry[path] = new Loader(path, resolveParameter(dependency, context)))).pledge;\n\t\t\t} else {\n\t\t\t\tif(!isInstanceOf(dependency, Pledge)) {\n\t\t\t\t\tdeferred = Pledge.defer();\n\t\t\t\t\t\n\t\t\t\t\tdeferred.resolve(dependency);\n\t\t\t\t\t\n\t\t\t\t\treturn deferred.pledge;\n\t\t\t\t} else {\n\t\t\t\t\treturn dependency;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction resolveParameter(path, context) {\n\t\t\tvar parameter = path.match(regexMatchParameter),\n\t\t\t\tpattern   = settings.pattern,\n\t\t\t\tmatch;\n\t\t\t\n\t\t\tpath = resolvePath(path, context);\n\t\t\t\n\t\t\tif(!regexIsAbsoluteUri.test(path)) {\n\t\t\t\titerate(pattern, function(property, value) {\n\t\t\t\t\tvalue.matches(path) && (!match || match.weight < value.weight) && (match = value);\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tmock:     (parameter && parameter[1]) ? true : false,\n\t\t\t\tcache:    (parameter && parameter[2]) ? parameter[2] === '+' : NULL,\n\t\t\t\thandler:  (parameter && parameter[3]) || settings.handler,\n\t\t\t\tversion:  (parameter && parameter[4]) || settings.version,\n\t\t\t\tlifetime: (parameter && parameter[5] && parameter[5] * 1000) || settings.lifetime,\n\t\t\t\turl:      match ? resolveUrl(match.process(path)) : path\n\t\t\t};\n\t\t}\n\t\t\n\t\tfunction resolveLoader(loader) {\n\t\t\tvar handler = loader.handler;\n\t\t\t\n\t\t\temit('preProcess', loader);\n\t\t\t\n\t\t\tif(loader.deferred.pledge.isPending()) {\n\t\t\t\thandler.onPreProcess && handler.onPreProcess.call(loader);\n\t\t\t\thandler.process && queue.enqueue(loader);\n\t\t\t\t!currentQueueItem && processQueue();\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction mergeProperties(property, value) {\n\t\t\tvar targetProperty = this[property],\n\t\t\t\ttargetPropertyIsObject;\n\t\t\t\n\t\t\tif(value !== undefined) {\n\t\t\t\tif(isObject(value)) {\n\t\t\t\t\ttargetPropertyIsObject = isObject(targetProperty);\n\t\t\t\t\t\n\t\t\t\t\tif(value.length !== undefined) {\n\t\t\t\t\t\ttargetProperty = (targetPropertyIsObject && targetProperty.length !== undefined) ? targetProperty : [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttargetProperty = (targetPropertyIsObject && targetProperty.length === undefined) ? targetProperty : {};\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis[property] = merge(targetProperty, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis[property] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * isArray\n\t\t *\n\t\t * Check whether a given value is of type array\n\t\t *\n\t\t * @param value\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tfunction isArray(value) {\n\t\t\treturn objectPrototypeToString.call(value) === '[object Array]';\n\t\t}\n\t\t\n\t\t/**\n\t\t * isObject\n\t\t *\n\t\t * Check whether a given object is of type object\n\t\t *\n\t\t * @param object\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tfunction isObject(object) {\n\t\t\treturn object && isTypeOf(object, 'object');\n\t\t}\n\t\t\n\t\t/**\n\t\t * isTypeOf\n\t\t *\n\t\t * Check whether a given object is of specified type\n\t\t *\n\t\t * @param object\n\t\t * @param {string} type\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tfunction isTypeOf(object, type) {\n\t\t\treturn typeof object === type;\n\t\t}\n\t\t\n\t\t/**\n\t\t * isInstanceOf\n\t\t *\n\t\t * Check whether a given object is an instance of specified type\n\t\t *\n\t\t * @param object\n\t\t * @param module\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tfunction isInstanceOf(object, module) {\n\t\t\treturn object instanceof module;\n\t\t}\n\t\t\n\t\t/**\n\t\t * isPositiveInteger\n\t\t *\n\t\t * Check whether a given value is a positive integer\n\t\t *\n\t\t * @param value\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tfunction isPositiveInteger(value) {\n\t\t\treturn isTypeOf(value, 'number') && isFinite(value) && Math.floor(value) === value && value >= 0;\n\t\t}\n\t\t\n\t\t/**\n\t\t * merge\n\t\t *\n\t\t * Merge two or more objects into the first one passed in\n\t\t *\n\t\t * @param {...object} object\n\t\t *\n\t\t * @return {object}\n\t\t */\n\t\tfunction merge() {\n\t\t\tvar target = arguments[0],\n\t\t\t\ti = 1, properties;\n\t\t\t\n\t\t\tfor(; (properties = arguments[i]) !== undefined; i++) {\n\t\t\t\titerate(properties, mergeProperties, target);\n\t\t\t}\n\t\t\t\n\t\t\treturn target;\n\t\t}\n\t\t\n\t\t/**\n\t\t * iterate\n\t\t *\n\t\t * Iterate over enumerable & own properties of a given\n\t\t * object and pass current property as well as its value\n\t\t * to a callback function\n\t\t *\n\t\t * @param {object} object\n\t\t * @param {function} callback\n\t\t * @param context\n\t\t *\n\t\t * @return {object}\n\t\t */\n\t\tfunction iterate(object, callback, context) {\n\t\t\tvar properties = Object.keys(object),\n\t\t\t\ti = 0, property;\n\t\t\t\n\t\t\tfor(; (property = properties[i]) !== undefined; i++) {\n\t\t\t\tif(callback.call(context, property, object[property]) === false) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvar defer = (function() {\n\t\t\tvar hasSetImmediate = 'setImmediate' in global,\n\t\t\t\telement, fallback;\n\t\t\t\n\t\t\tif('MutationObserver' in global) {\n\t\t\t\treturn function defer(fn) {\n\t\t\t\t\telement = document.createElement('div');\n\t\t\t\t\t\n\t\t\t\t\tnew MutationObserver(function() { fn(); })\n\t\t\t\t\t\t.observe(element, { attributes: true });\n\t\t\t\t\t\n\t\t\t\t\telement.setAttribute('i', '1');\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tif(!hasSetImmediate && 'postMessage' in global && 'addEventListener' in global) {\n\t\t\t\treturn (function() {\n\t\t\t\t\tvar prefix  = 'com.async',\n\t\t\t\t\t\tregex   = new RegExp('^com\\\\.async\\\\[([a-f0-9]{8,8}-[a-f0-9]{4,4}-4[a-f0-9]{3,3}-[a-f0-9]{4,4}-[a-f0-9]{12,12})\\\\]$', 'g'),\n\t\t\t\t\t\tstorage = {},\n\t\t\t\t\t\tmatches;\n\t\t\t\t\t\n\t\t\t\t\tfunction onMessage(event) {\n\t\t\t\t\t\tif(event.source === global && (matches = regex.exec(event.data))) {\n\t\t\t\t\t\t\tstorage[matches[1]]();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdelete storage[matches[1]];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tglobal.addEventListener('message', onMessage, false);\n\t\t\t\t\t\n\t\t\t\t\treturn function defer(fn) {\n\t\t\t\t\t\tvar uuid = Uuid.generate();\n\t\t\t\t\t\t\n\t\t\t\t\t\tstorage[uuid] = fn;\n\t\t\t\t\t\t\n\t\t\t\t\t\tglobal.postMessage(prefix + '[' + uuid + ']', '*');\n\t\t\t\t\t}\n\t\t\t\t}());\n\t\t\t}\n\t\t\t\n\t\t\tif(!hasSetImmediate && 'onreadystatechange' in (element = document.createElement('script'))) {\n\t\t\t\treturn function defer(fn) {\n\t\t\t\t\telement.onreadystatechange = function onreadystatechange() {\n\t\t\t\t\t\telement.onreadystatechange = NULL;\n\t\t\t\t\t\telement.parentNode.removeChild(element);\n\t\t\t\t\t\t\n\t\t\t\t\t\tfn();\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tdocument.body.appendChild(element);\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tfallback = hasSetImmediate ? setImmediate : setTimeout;\n\t\t\t\n\t\t\treturn function defer(fn) {\n\t\t\t\tfallback(fn);\n\t\t\t}\n\t\t}());\n\t\n\t/**\n\t * --------------------------------\n\t * Classes\n\t * --------------------------------\n\t */\n\t\tvar Uuid = (function() {\n\t\t\tvar objectDefineProperty = Object.defineProperty,\n\t\t\t\tregex                = new RegExp('[xy]', 'g'),\n\t\t\t\tstorage              = {};\n\t\t\t\n\t\t\tfunction randomize(character) {\n\t\t\t\tvar r = Math.random() * 16 | 0;\n\t\t\t\t\n\t\t\t\treturn ((character === 'x') ? r : (r & 0x3 | 0x8)).toString(16);\n\t\t\t}\n\t\t\t\n\t\t\tfunction Uuid() {}\n\t\t\t\n\t\t\tUuid.prototype = {\n\t\t\t\tgenerate: function() {\n\t\t\t\t\tvar result;\n\t\t\t\t\t\n\t\t\t\t\tdo {\n\t\t\t\t\t\tresult = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, randomize);\n\t\t\t\t\t} while(storage[result]);\n\t\t\t\t\t\n\t\t\t\t\tstorage[result] = 1;\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t},\n\t\t\t\tset: function(target) {\n\t\t\t\t\tif(typeof target.uuid === 'undefined') {\n\t\t\t\t\t\tobjectDefineProperty(target, 'uuid', {\n\t\t\t\t\t\t\t__proto__:    NULL,\n\t\t\t\t\t\t\tvalue:        this.generate(),\n\t\t\t\t\t\t\tenumerable:   false,\n\t\t\t\t\t\t\tconfigurable: false,\n\t\t\t\t\t\t\twritable:     false\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn target.uuid;\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\treturn new Uuid();\n\t\t}());\n\t\tvar Pledge = (function() {\n\t\t\tvar PLEDGE_PENDING  = 'pending',\n\t\t\t\tPLEDGE_RESOLVED = 'resolved',\n\t\t\t\tPLEDGE_REJECTED = 'rejected',\n\t\t\t\tstorage         = {};\n\t\t\t\n\t\t\tfunction resolve() {\n\t\t\t\tstorage[this.uuid].handle(PLEDGE_RESOLVED, arguments);\n\t\t\t}\n\t\t\t\n\t\t\tfunction reject() {\n\t\t\t\tstorage[this.uuid].handle(PLEDGE_REJECTED, arguments);\n\t\t\t}\n\t\t\t\n\t\t\tfunction handle(state, parameter) {\n\t\t\t\tvar self     = this,\n\t\t\t\t\tlistener = storage[self.uuid],\n\t\t\t\t\tpointer, result;\n\t\t\t\t\n\t\t\t\tif(self.state === PLEDGE_PENDING) {\n\t\t\t\t\tself.state = state;\n\t\t\t\t\tself.value = parameter;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\twhile(pointer = listener[self.state].shift()) {\n\t\t\t\t\tresult = pointer.handler.apply(NULL, self.value);\n\t\t\t\t\t\n\t\t\t\t\tif(result && typeof result.then === 'function') {\n\t\t\t\t\t\tresult.then(pointer.deferred.resolve, pointer.deferred.reject);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpointer.deferred[self.state === PLEDGE_RESOLVED ? 'resolve' : 'reject'].apply(NULL, self.value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlistener[PLEDGE_RESOLVED].length = 0;\n\t\t\t\tlistener[PLEDGE_REJECTED].length = 0;\n\t\t\t}\n\t\t\t\n\t\t\tfunction observe(pledge, index, properties) {\n\t\t\t\tpledge.then(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tproperties.resolved[index] = arrayPrototypeSlice.call(arguments);\n\t\t\t\t\t\t\n\t\t\t\t\t\tproperties.count++;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcheck(properties);\n\t\t\t\t\t},\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tproperties.rejected.push(arrayPrototypeSlice.call(arguments));\n\t\t\t\t\t\t\n\t\t\t\t\t\tcheck(properties);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\t\n\t\t\tfunction check(properties) {\n\t\t\t\tif(properties.count === properties.total) {\n\t\t\t\t\tproperties.deferred.resolve.apply(NULL, arrayPrototypeConcat.apply([], properties.resolved));\n\t\t\t\t} else if(properties.rejected.length + properties.count === properties.total) {\n\t\t\t\t\tproperties.deferred.reject.apply(NULL, arrayPrototypeConcat.apply([], properties.rejected));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfunction Pledge(executor) {\n\t\t\t\tvar self = this;\n\t\t\t\t\n\t\t\t\tstorage[Uuid.set(self)] = { handle: handle.bind(self), resolved: [], rejected: [] };\n\t\t\t\t\n\t\t\t\texecutor(resolve.bind(self), reject.bind(self));\n\t\t\t}\n\t\t\t\n\t\t\tPledge.prototype = {\n\t\t\t\t/* only for reference\n\t\t\t\tuuid:   NULL,\n\t\t\t\tvalue:  NULL,\n\t\t\t\tthen:   NULL,\n\t\t\t\tcache:  NULL, // will only be set by storage\n\t\t\t\t*/\n\t\t\t\tstate:  PLEDGE_PENDING,\n\t\t\t\talways: function(alwaysListener) {\n\t\t\t\t\treturn this.then(alwaysListener, alwaysListener);\n\t\t\t\t},\n\t\t\t\tthen: function(resolveListener, rejectListener) {\n\t\t\t\t\tvar self       = this,\n\t\t\t\t\t\tproperties = storage[self.uuid],\n\t\t\t\t\t\tdeferred   = Pledge.defer();\n\t\t\t\t\t\n\t\t\t\t\tresolveListener && properties[PLEDGE_RESOLVED].push({ handler: resolveListener, deferred: deferred });\n\t\t\t\t\trejectListener && properties[PLEDGE_REJECTED].push({ handler: rejectListener, deferred: deferred });\n\t\t\t\t\t\n\t\t\t\t\tif(self.state !== PLEDGE_PENDING) {\n\t\t\t\t\t\tproperties.handle();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn deferred.pledge;\n\t\t\t\t},\n\t\t\t\tisPending: function() {\n\t\t\t\t\treturn this.state === PLEDGE_PENDING;\n\t\t\t\t},\n\t\t\t\tisResolved: function() {\n\t\t\t\t\treturn this.state === PLEDGE_RESOLVED;\n\t\t\t\t},\n\t\t\t\tisRejected: function() {\n\t\t\t\t\treturn this.state === PLEDGE_REJECTED;\n\t\t\t\t}\n\t\t\t};\n\t\t\n\t\t\tPledge.defer = function() {\n\t\t\t\tvar self = {};\n\t\t\t\t\n\t\t\t\tself.pledge = new Pledge(function(resolveListener, rejectListener) {\n\t\t\t\t\tself.resolve = resolveListener;\n\t\t\t\t\tself.reject  = rejectListener;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn self;\n\t\t\t};\n\t\t\t\n\t\t\tPledge.all = function(pledges) {\n\t\t\t\tvar deferred   = Pledge.defer(),\n\t\t\t\t\tproperties = (storage[Uuid.generate()] = { deferred: deferred, resolved: [], rejected: [], total: pledges.length, count: 0 }),\n\t\t\t\t\ti = 0, pledge;\n\t\t\t\t\n\t\t\t\tfor(; pledge = pledges[i]; i++) {\n\t\t\t\t\tobserve(pledge, i, properties)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn deferred.pledge;\n\t\t\t};\n\t\t\t\n\t\t\tPledge.race = function(pledges) {\n\t\t\t\tvar deferred = Pledge.defer(),\n\t\t\t\t\ti = 0, pledge;\n\t\t\t\t\n\t\t\t\tfor(; pledge = pledges[i]; i++) {\n\t\t\t\t\tpledge.then(deferred.resolve, deferred.reject);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn deferred.pledge;\n\t\t\t};\n\t\t\t\n\t\t\treturn Pledge;\n\t\t}());\n\t\tvar currentQueueItem = NULL;\n\t\t\n\t\tfunction processQueue() {\n\t\t\tif(queue.length) {\n\t\t\t\tcurrentQueueItem = queue.dequeue();\n\t\t\n\t\t\t\tcurrentQueueItem.handler.process.call(currentQueueItem);\n\t\t\t\temit('postProcess', currentQueueItem);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar Queue = (function() {\n\t\t\tvar storage = {};\n\t\t\n\t\t\tfunction Queue() {\n\t\t\t\tUuid.set(this);\n\t\t\n\t\t\t\tstorage[this.uuid] = [];\n\t\t\t}\n\t\t\t\n\t\t\tQueue.prototype = {\n\t\t\t\t/* only for reference\n\t\t\t\t uuid: NULL,\n\t\t\t\t */\n\t\t\t\tenqueue: function() {\n\t\t\t\t\tstorage[this.uuid] = storage[this.uuid].concat(arrayPrototypeSlice.call(arguments));\n\t\t\t\t},\n\t\t\t\tdequeue: function() {\n\t\t\t\t\treturn storage[this.uuid].shift();\n\t\t\t\t},\n\t\t\t\tget current() {\n\t\t\t\t\treturn storage[this.uuid][0];\n\t\t\t\t},\n\t\t\t\tget length() {\n\t\t\t\t\treturn storage[this.uuid].length;\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\treturn Queue;\n\t\t}());\n\t\tvar Pattern = (function() {\n\t\t\tfunction Pattern(pattern, url) {\n\t\t\t\tvar self = this;\n\t\t\t\t\n\t\t\t\tself.weight       = pattern.length;\n\t\t\t\tself.url          = resolveUrl(url).replace(regexMatchTrailingSlash, '$1');\n\t\t\t\tself.matchPattern = createRegularExpression('^' + escapeRegularExpression(pattern));\n\t\t\t\tself.matchUrl     = createRegularExpression('^' + escapeRegularExpression(url));\n\t\t\t}\n\t\t\t\n\t\t\tPattern.prototype = {\n\t\t\t\t/* only for reference\n\t\t\t\t weight:       0,\n\t\t\t\t url:          NULL,\n\t\t\t\t matchPattern: NULL,\n\t\t\t\t matchUrl:     NULL,\n\t\t\t\t */\n\t\t\t\tmatches: function(path) {\n\t\t\t\t\treturn this.matchPattern.test(path);\n\t\t\t\t},\n\t\t\t\tremove: function(url) {\n\t\t\t\t\treturn url.replace(this.matchUrl, '');\n\t\t\t\t},\n\t\t\t\tprocess: function(path) {\n\t\t\t\t\treturn path.replace(this.matchPattern, this.url);\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\treturn Pattern;\n\t\t}());\n\t\tvar Loader = (function() {\n\t\t\tfunction Loader(path, parameter) {\n\t\t\t\tvar self     = this,\n\t\t\t\t\tdeferred = Pledge.defer(),\n\t\t\t\t\tpledge   = deferred.pledge,\n\t\t\t\t\thandler  = parameter.handler,\n\t\t\t\t\txhr, timeout;\n\t\t\t\t\n\t\t\t\tself.deferred = deferred;\n\t\t\t\tself.path     = path;\n\t\t\t\tself.url      = parameter.url;\n\t\t\t\tself.cache    = parameter.cache;\n\t\t\t\tself.version  = parameter.version;\n\t\t\t\tself.lifetime = parameter.lifetime;\n\t\t\t\t\n\t\t\t\tdemand(MODULE_PREFIX_HANDLER + handler)\n\t\t\t\t\t.then(\n\t\t\t\t\t\tfunction(handler) {\n\t\t\t\t\t\t\tself.handler = handler;\n\t\t\t\t\t\t\tself.mock    = parameter.mock ? mocks[self.path] : NULL;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\thandler.onPreRequest && handler.onPreRequest.call(self);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(!self.mock) {\n\t\t\t\t\t\t\t\tif(self.cache === false || !storage.get(self)) {\n\t\t\t\t\t\t\t\t\temit('preRequest', self);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif(pledge.isPending()) {\n\t\t\t\t\t\t\t\t\t\txhr = regexMatchBaseUrl.test(self.url) ? new XHR() : new XDR();\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\txhr.onprogress = function() {};\n\t\t\t\t\t\t\t\t\t\txhr.ontimeout = xhr.onerror = xhr.onabort = function() {\n\t\t\t\t\t\t\t\t\t\t\tdeferred.reject(new Failure('timeout requesting', self.path));\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\txhr.onload = function() {\n\t\t\t\t\t\t\t\t\t\t\tvar type = xhr.getResponseHeader && xhr.getResponseHeader('content-type');\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ttimeout = clearTimeout(timeout);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif((!('status' in xhr) || xhr.status === 200) && (!type || !handler.matchType || handler.matchType.test(type))) {\n\t\t\t\t\t\t\t\t\t\t\t\tself.source = xhr.responseText;\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\temit('postRequest', self);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tif(pledge.isPending()) {\n\t\t\t\t\t\t\t\t\t\t\t\t\thandler.onPostRequest && handler.onPostRequest.call(self);\n\t\t\t\t\t\t\t\t\t\t\t\t\tresolveLoader(self);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(self.cache !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpledge.then(function() { storage.set(self); });\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tdeferred.reject(new Failure('error requesting', self.path));\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\txhr.open('GET', self.url, true);\n\t\t\t\t\t\t\t\t\t\txhr.send();\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\tif(xhr.readyState < 4) {\n\t\t\t\t\t\t\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}, settings.timeout);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tresolveLoader(self);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif(self.mock.dependencies) {\n\t\t\t\t\t\t\t\t\tself.mock.dependencies.then(\n\t\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\t\tself.mock.resolve(self);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tself.mock.reject\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tself.mock.resolve(self);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdeferred.reject\n\t\t\t\t\t);\n\t\t\t\t\n\t\t\t\treturn deferred;\n\t\t\t}\n\t\t\t\n\t\t\t/* only for reference\n\t\t\t Loader.prototype = {\n\t\t\t deferred: NULL,\n\t\t\t path:     NULL,\n\t\t\t url:      NULL,\n\t\t\t handler:  NULL,\n\t\t\t source:   NULL,\n\t\t\t mock:     NULL,\n\t\t\t cache:    NULL,\n\t\t\t lifetime: NULL,\n\t\t\t version:  NULL,\n\t\t\t state:    { version: NULL, expires: NULL, url: NULL } // will only be set by storage\n\t\t\t };\n\t\t\t */\n\t\t\t\n\t\t\treturn Loader;\n\t\t}());\n\t\tvar Failure = (function() {\n\t\t\tfunction Failure(message, module, stack) {\n\t\t\t\tthis.message = message;\n\t\t\t\t\n\t\t\t\tmodule && (this.module = module);\n\t\t\t\tstack && (this.stack = arrayPrototypeSlice.call(stack));\n\t\t\t}\n\t\t\t\n\t\t\tFailure.prototype = {\n\t\t\t\t/* only for reference\n\t\t\t\t message: NULL,\n\t\t\t\t module:  NULL,\n\t\t\t\t stack:   NULL,\n\t\t\t\t */\n\t\t\t\ttoString: function() {\n\t\t\t\t\tvar self   = this,\n\t\t\t\t\t\tresult = DEMAND_ID + ': ' + self.message + ' ' + (self.module ? '\"' + self.module + '\"' : '');\n\t\t\t\t\t\n\t\t\t\t\tif(self.stack) {\n\t\t\t\t\t\tresult = Failure.traverse(self.stack, result, 1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\tFailure.traverse = function(stack, value, depth) {\n\t\t\t\tvar indention = new Array(depth + 1).join(' '),\n\t\t\t\t\ti = 0, item;\n\t\t\t\t\n\t\t\t\tfor(; item = stack[i]; i++) {\n\t\t\t\t\tvalue += '\\n' + indention + '> ' + item.message + ' ' + (item.module ? '\"' + item.module + '\"' : '');\n\t\t\t\t\t\n\t\t\t\t\tif(item.stack) {\n\t\t\t\t\t\tvalue = Failure.traverse(item.stack, value, depth + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn value;\n\t\t\t};\n\t\t\t\n\t\t\treturn Failure;\n\t\t}());\n\t\n\t/**\n\t * --------------------------------\n\t * Demand\n\t * --------------------------------\n\t */\n\t\tfunction demand() {\n\t\t\tvar dependencies = arrayPrototypeSlice.call(arguments),\n\t\t\t\tcontext      = this !== window ? this : NULL,\n\t\t\t\ti = 0, dependency;\n\t\t\t\n\t\t\temit('preResolve', dependencies, context);\n\t\t\t\n\t\t\tfor(; (dependency = dependencies[i]); i++) {\n\t\t\t\tdependencies[i] = resolveDependency(dependency, context);\n\t\t\t}\n\t\t\t\n\t\t\temit('postResolve', dependencies, context);\n\t\t\t\n\t\t\treturn Pledge.all(dependencies);\n\t\t}\n\t\t\n\t\tdemand.configure = function(parameter) {\n\t\t\tvar cache    = parameter.cache,\n\t\t\t\tversion  = parameter.version,\n\t\t\t\ttimeout  = parameter.timeout,\n\t\t\t\tlifetime = parameter.lifetime,\n\t\t\t\tbase     = parameter.base,\n\t\t\t\tpattern  = parameter.pattern,\n\t\t\t\tmodules  = parameter.modules,\n\t\t\t\tpointer  = settings.modules,\n\t\t\t\ttemp;\n\t\t\t\n\t\t\tif(isTypeOf(cache, STRING_BOOLEAN)) {\n\t\t\t\tsettings.cache[''] = { weight: 0, state: cache };\n\t\t\t} else if(isObject(cache)) {\n\t\t\t\titerate(cache, function(property, value) {\n\t\t\t\t\tsettings.cache[property] = { weight: property.length, state: value };\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif(isTypeOf(version, STRING_STRING)) {\n\t\t\t\tsettings.version = version;\n\t\t\t}\n\t\t\t\n\t\t\tif(isPositiveInteger(timeout)) {\n\t\t\t\tsettings.timeout = Math.min(Math.max(timeout, 2), 12) * 1000;\n\t\t\t}\n\t\t\t\n\t\t\tif(isPositiveInteger(lifetime) && lifetime > 0) {\n\t\t\t\tsettings.lifetime = lifetime * 1000;\n\t\t\t}\n\t\t\t\n\t\t\tif(isTypeOf(base, STRING_STRING) && base !== '') {\n\t\t\t\tsettings.pattern.base = new Pattern('', base);\n\t\t\t}\n\t\t\t\n\t\t\tif(isObject(pattern)) {\n\t\t\t\titerate(pattern, function(property, value) {\n\t\t\t\t\tproperty !== 'base' && (settings.pattern[property] = new Pattern(property, value));\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif(isObject(modules)) {\n\t\t\t\titerate(modules, function(property, value) {\n\t\t\t\t\tif(property !== MODULE_PREFIX_STORAGE) {\n\t\t\t\t\t\ttemp = pointer[property] = pointer[property] || {};\n\n\t\t\t\t\t\temit('preConfigure:' + property, temp);\n\n\t\t\t\t\t\tmerge(temp, value);\n\n\t\t\t\t\t\temit('postConfigure:' + property, temp);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\treturn demand;\n\t\t};\n\t\t\n\t\tdemand.remove = function(path) {\n\t\t\tif(registry[path]) {\n\t\t\t\t!!registry[path].cache && storage.clean.path(path);\n\t\t\t\t\n\t\t\t\tdelete registry[path];\n\t\t\t}\n\t\t\t\n\t\t\treturn demand;\n\t\t};\n\t\t\n\t\tdemand.on = function(events, callback) {\n\t\t\tvar event, pointer;\n\t\t\t\n\t\t\tif(isTypeOf(events, STRING_STRING) && isTypeOf(callback, STRING_FUNCTION)) {\n\t\t\t\tevents = events.split(' ');\n\t\t\t\t\n\t\t\t\twhile(event = events.shift()) {\n\t\t\t\t\tif(regexMatchEvent.test(event)) {\n\t\t\t\t\t\t(listener[event] || (listener[event] = [])).push(callback);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(event.indexOf('postConfigure:') === 0) {\n\t\t\t\t\t\t\tpointer = settings.modules[event.substr(14)];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(pointer !== undefined) {\n\t\t\t\t\t\t\t\tcallback(pointer);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn demand;\n\t\t};\n\t\t\n\t\tdemand.list = function(state) {\n\t\t\tvar keys, pledge;\n\t\t\t\n\t\t\tif(state) {\n\t\t\t\tkeys = [];\n\n\t\t\t\titerate(registry, function(property, value) {\n\t\t\t\t\tpledge = value.pledge;\n\n\t\t\t\t\tif(pledge.state === state || pledge.cache === state) {\n\t\t\t\t\t\tkeys.push(property);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tkeys = Object.keys(registry);\n\t\t\t}\n\t\t\t\n\t\t\treturn keys;\n\t\t};\n\n\t\t\n\t/**\n\t * --------------------------------\n\t * Provide\n\t * --------------------------------\n\t */\n\t\tfunction provide() {\n\t\t\tvar parameter    = arguments,\n\t\t\t\tpath         = isTypeOf(parameter[0], STRING_STRING) ? parameter[0] : NULL,\n\t\t\t\tdependencies = isArray(parameter[path ? 1 : 0]) ? parameter[path ? 1 : 0] : NULL,\n\t\t\t\tdefinition   = dependencies ? parameter[path ? 2 : 1] : parameter[path ? 1 : 0],\n\t\t\t\tdeferred, pledge, isFunction;\n\n\t\t\tif(!path && currentQueueItem) {\n\t\t\t\tpath = currentQueueItem.path;\n\n\t\t\t\tcurrentQueueItem = processQueue();\n\n\t\t\t\tqueue.length > 0 && (currentQueueItem = queue.dequeue()) && processQueue();\n\t\t\t}\n\n\t\t\tif(path) {\n\t\t\t\tpath       = resolvePath(path, this);\n\t\t\t\tdeferred   = registry[path] || (registry[path] = Pledge.defer());\n\t\t\t\tpledge     = deferred.pledge;\n\t\t\t\tisFunction = isTypeOf(definition, STRING_FUNCTION);\n\t\t\t\t\n\t\t\t\tif(pledge.isPending()) {\n\t\t\t\t\tif(dependencies) {\n\t\t\t\t\t\tdemand\n\t\t\t\t\t\t\t.apply(path, dependencies)\n\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\tfunction() { deferred.resolve(isFunction ? definition.apply(NULL, arguments) : definition); },\n\t\t\t\t\t\t\t\tfunction() { log(new Failure('error providing ' + path)); }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeferred.resolve(isFunction ? definition() : definition);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow new Failure('unspecified anonymous provide');\n\t\t\t}\n\t\t}\n\t\n\t/**\n\t * --------------------------------\n\t * Modules\n\t * --------------------------------\n\t */\n\t\t/**\n\t\t * /demand/storage\n\t\t */\n\t\t(function(){\n\t\t\tfunction definition() {\n\t\t\t\tvar STORAGE_PREFIX       = '[' + DEMAND_ID + ']',\n\t\t\t\t\tSTORAGE_SUFFIX_STATE = '[state]',\n\t\t\t\t\tSTORAGE_SUFFIX_VALUE = '[value]',\n\t\t\t\t\tregexMatchState      = createRegularExpression('^' + escapeRegularExpression(STORAGE_PREFIX) + '\\\\[(.+?)\\\\]' + escapeRegularExpression(STORAGE_SUFFIX_STATE) + '$'),\n\t\t\t\t\tlocalStorage         = (function() { try { return 'localStorage' in global && global.localStorage; } catch(exception) { return false; } }()),\n\t\t\t\t\thasRemainingSpace    = localStorage && 'remainingSpace' in localStorage;\n\t\t\t\t\n\t\t\t\tfunction isEnabled(loader) {\n\t\t\t\t\tvar match;\n\t\t\t\t\t\n\t\t\t\t\tif(loader.cache !== NULL) {\n\t\t\t\t\t\treturn loader.cache;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\titerate(settings.cache, function(property, value) {\n\t\t\t\t\t\tif(loader.path.indexOf(property) === 0 && (!match || value.weight > match.weight)) {\n\t\t\t\t\t\t\tmatch = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\treturn match ? match.state : false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction Storage() {\n\t\t\t\t\tthis.clear.expired();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tStorage.prototype = {\n\t\t\t\t\tget: function(loader) {\n\t\t\t\t\t\tvar path = loader.path,\n\t\t\t\t\t\t\tid, state, pledge;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(localStorage && isEnabled(loader)) {\n\t\t\t\t\t\t\tid     = STORAGE_PREFIX + '[' + path + ']';\n\t\t\t\t\t\t\tstate  = JSON.parse(localStorage.getItem(id + STORAGE_SUFFIX_STATE));\n\t\t\t\t\t\t\tpledge = loader.deferred.pledge;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(state && state.version === loader.version && state.url === loader.url && ((!state.expires && !loader.lifetime) || state.expires > getTimestamp())) {\n\t\t\t\t\t\t\t\tpledge.cache  = 'hit';\n\t\t\t\t\t\t\t\tloader.source = localStorage.getItem(id + STORAGE_SUFFIX_VALUE);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\temit('cacheHit', loader);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\treturn loader.source;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpledge.cache = 'miss';\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\temit('cacheMiss', loader);\n\t\t\t\t\t\t\t\tthis.clear.path(path);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tset: function(loader) {\n\t\t\t\t\t\tvar path = loader.path,\n\t\t\t\t\t\t\tlifetime, id, spaceBefore;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(localStorage && isEnabled(loader)) {\n\t\t\t\t\t\t\temit('preCache', loader);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tlifetime = loader.lifetime;\n\t\t\t\t\t\t\tid       = STORAGE_PREFIX + '[' + path + ']';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tloader.state = { version: loader.version, expires: lifetime ? getTimestamp() + lifetime : lifetime, url: loader.url };\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tspaceBefore = hasRemainingSpace ? localStorage.remainingSpace : NULL;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlocalStorage.setItem(id + STORAGE_SUFFIX_VALUE, loader.source);\n\t\t\t\t\t\t\t\tlocalStorage.setItem(id + STORAGE_SUFFIX_STATE, JSON.stringify(loader.state));\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// strict equality check with \"===\" is required due to spaceBefore might be \"0\"\n\t\t\t\t\t\t\t\tif(spaceBefore !== NULL && localStorage.remainingSpace === spaceBefore) {\n\t\t\t\t\t\t\t\t\tthrow new Error('QUOTA_EXCEEDED_ERR');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\temit('postCache', loader);\n\t\t\t\t\t\t\t} catch(error) {\n\t\t\t\t\t\t\t\temit('cacheExceed', loader);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tclear: {\n\t\t\t\t\t\tpath: function(path) {\n\t\t\t\t\t\t\tvar id;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(localStorage) {\n\t\t\t\t\t\t\t\tid = STORAGE_PREFIX + '[' + path + ']';\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlocalStorage.removeItem(id + STORAGE_SUFFIX_STATE);\n\t\t\t\t\t\t\t\tlocalStorage.removeItem(id + STORAGE_SUFFIX_VALUE);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\temit('cacheClear', path);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tall: function() {\n\t\t\t\t\t\t\tvar match;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(localStorage) {\n\t\t\t\t\t\t\t\titerate(localStorage, function(property) {\n\t\t\t\t\t\t\t\t\tmatch = property.match(regexMatchState);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tmatch && this.path(match[1]);\n\t\t\t\t\t\t\t\t}, this);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\texpired: function() {\n\t\t\t\t\t\t\tvar match, state;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(localStorage) {\n\t\t\t\t\t\t\t\titerate(localStorage, function(property) {\n\t\t\t\t\t\t\t\t\tmatch = property.match(regexMatchState);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif(match) {\n\t\t\t\t\t\t\t\t\t\tstate = JSON.parse(localStorage.getItem(STORAGE_PREFIX + '[' + match[1] + ']' + STORAGE_SUFFIX_STATE));\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(state && state.expires > 0 && state.expires <= getTimestamp()) {\n\t\t\t\t\t\t\t\t\t\t\tthis.path(match[1]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}, this);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tdemand.clear = (storage = new Storage()).clear;\n\t\t\t\t\n\t\t\t\treturn storage;\n\t\t\t}\n\t\t\t\n\t\t\tprovide(MODULE_PREFIX_STORAGE, definition);\n\t\t}());\n\t\t/**\n\t\t * /demand/handler/module\n\t\t */\n\t\t\n\t\t(function() {\n\t\t\tfunction definition() {\n\t\t\t\tvar target              = document.getElementsByTagName('head')[0],\n\t\t\t\t\tregexMatchSourcemap = /\\/\\/#\\s+sourceMappingURL\\s*=\\s*(?!(?:http[s]?:)?\\/\\/)(.+?)\\.map/g;\n\t\t\t\t\n\t\t\t\treturn {\n\t\t\t\t\tmatchType: /^(application|text)\\/(x-)?javascript/,\n\t\t\t\t\tonPreRequest: function() {\n\t\t\t\t\t\tvar url  = this.url;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.url = url.slice(-3) !== '.js' ? url + '.js' : url;\n\t\t\t\t\t},\n\t\t\t\t\tonPostRequest: function() {\n\t\t\t\t\t\tvar self   = this,\n\t\t\t\t\t\t\tsource = self.source,\n\t\t\t\t\t\t\tmatch, replacement;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(source) {\n\t\t\t\t\t\t\twhile(match = regexMatchSourcemap.exec(source)) {\n\t\t\t\t\t\t\t\tif(regexIsAbsolutePath.test(match[1])) {\n\t\t\t\t\t\t\t\t\tresolver.href = self.url;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\treplacement = resolver.protocol + '//' + resolver.host + match[1];\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treplacement = resolveUrl(self.url + '/../' + match[1]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tsource = source.replace(match[0], '//# sourceMappingURL=' + replacement + '.map');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tself.source = source;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tprocess: function() {\n\t\t\t\t\t\tvar source = this.source,\n\t\t\t\t\t\t\tscript;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(source) {\n\t\t\t\t\t\t\tscript       = document.createElement('script');\n\t\t\t\t\t\t\tscript.async = true;\n\t\t\t\t\t\t\tscript.text  = source;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tscript.setAttribute('demand-path', this.path);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\ttarget.appendChild(script);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tprovide(MODULE_PREFIX_HANDLER + 'module', definition);\n\t\t}());\n\t\t/**\n\t\t * /demand/handler/bundle\n\t\t */\n\t\t(function() {\n\t\t\tvar path = MODULE_PREFIX_HANDLER + 'bundle',\n\t\t\t\tsettings;\n\t\t\t\n\t\t\tfunction definition(handlerModule) {\n\t\t\t\tfunction onPostConfigure(options) {\n\t\t\t\t\tsettings = isObject(options) ? options : {};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdemand.on('postConfigure:' + path, onPostConfigure);\n\t\t\n\t\t\t\treturn {\n\t\t\t\t\tmatchType:     handlerModule.matchType,\n\t\t\t\t\tonPostRequest: handlerModule.onPostRequest,\n\t\t\t\t\tonPreProcess: function() {\n\t\t\t\t\t\tvar self     = this,\n\t\t\t\t\t\t\tdeferred = self.deferred,\n\t\t\t\t\t\t\tmodules  = settings[self.path];\n\t\t\n\t\t\t\t\t\tconsole.log(self);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\tprovide(path, [ '/demand/handler/module' ], definition);\n\t\t}());\n\t\t/**\n\t\t * /demand/plugin/genie\n\t\t */\n\t\t(function() {\n\t\t\tvar path = MODULE_PREFIX_PLUGIN + 'genie';\n\t\t\t\n\t\t\tfunction definition() {\n\t\t\t\tvar pattern = [];\n\t\t\t\t\n\t\t\t\tfunction onPostConfigure(options) {\n\t\t\t\t\tif(isObject(options)) {\n\t\t\t\t\t\tpattern.length = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\titerate(options, function(property, value) {\n\t\t\t\t\t\t\tpattern.push({ prefix: property, weight: property.length, fn: value });\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdemand.on('postConfigure:' + path, onPostConfigure);\n\t\t\t\t\n\t\t\t\tfunction matchPattern(path) {\n\t\t\t\t\tvar i = 0, pointer, match;\n\t\t\t\t\t\n\t\t\t\t\tfor(; (pointer = pattern[i]); i++) {\n\t\t\t\t\t\tif(path.indexOf(pointer.prefix) === 0 && (!match || pointer.weight > match.weight)) {\n\t\t\t\t\t\t\tmatch = pointer;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction generateHash(value){\n\t\t\t\t\tvar hash = 5381,\n\t\t\t\t\t\ti    = value.length;\n\t\t\t\t\t\n\t\t\t\t\twhile(i) {\n\t\t\t\t\t\thash = (hash * 33) ^ value.charCodeAt(--i);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn hash >>> 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction generateConfiguration(bundle) {\n\t\t\t\t\tvar matches       = bundle.matches,\n\t\t\t\t\t\tconfiguration = { pattern: {}, modules: { '/demand/handler/bundle': {} } },\n\t\t\t\t\t\ti = 0, pointer, dependency;\n\t\t\t\t\t\n\t\t\t\t\tconfiguration.pattern[bundle.id]                           = bundle.fn(matches);\n\t\t\t\t\tconfiguration.modules['/demand/handler/bundle'][bundle.id] = pointer = [];\n\t\t\t\t\t\n\t\t\t\t\tfor(; (dependency = matches[i]); i++) {\n\t\t\t\t\t\tpointer.push(dependency.id);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn configuration;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction getModule(path) {\n\t\t\t\t\treturn (registry[path] && registry[path].pledge) || (mocks[path] && mocks[path].pledge);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction resolveDependencies() {\n\t\t\t\t\tvar i = 0, dependency;\n\t\t\t\t\t\n\t\t\t\t\tfor(; (dependency = this[i]); i++) {\n\t\t\t\t\t\tdependency.dfd.resolve(arguments[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction rejectDependencies() {\n\t\t\t\t\tvar i = 0, dependency;\n\t\t\t\t\t\n\t\t\t\t\tfor(; (dependency = this[i]); i++) {\n\t\t\t\t\t\tdependency.dfd.reject(new Failure('error resolving', dependency.path));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdemand.on('preResolve', function(dependencies, context) {\n\t\t\t\t\tvar bundles = {},\n\t\t\t\t\t\ti, dependency, id, parameter, pattern, matches;\n\t\t\t\t\t\n\t\t\t\t\tfor(i = 0; (dependency = dependencies[i]); i++) {\n\t\t\t\t\t\tif(isTypeOf(dependency, 'string')) {\n\t\t\t\t\t\t\tid = resolvePath(dependency, context);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(!getModule(id) && (parameter = resolveParameter(dependency, context)) && parameter.handler === 'module' && (pattern = matchPattern(id))) {\n\t\t\t\t\t\t\t\t(bundles[pattern.prefix] || (bundles[pattern.prefix] = { fn: pattern.fn, matches: [] })).matches.push({ id: id, path: dependency, index: i, dfd: NULL });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\titerate(bundles, function(property, value) {\n\t\t\t\t\t\tmatches = value.matches;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(matches.length > 1) {\n\t\t\t\t\t\t\tvalue.id = '/genie/' + generateHash(JSON.stringify(value.matches));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor(i = 0; (dependency = matches[i]); i++) {\n\t\t\t\t\t\t\t\tdependency.dfd                 = Pledge.defer();\n\t\t\t\t\t\t\t\tdependencies[dependency.index] = dependency.dfd.pledge;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tmockModules(dependency.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdemand.configure(generateConfiguration(value));\n\t\t\t\t\t\t\tdemand('bundle!' + value.id)\n\t\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\t\tresolveDependencies.bind(matches),\n\t\t\t\t\t\t\t\t\trejectDependencies.bind(matches)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t\n\t\t\tprovide(path, definition);\n\t\t}());\n\t\n\t/**\n\t * --------------------------------\n\t * Initialization\n\t * --------------------------------\n\t */\n\t\tregexMatchBaseUrl = createRegularExpression('^' + escapeRegularExpression(resolveUrl('/')));\n\t\t\n\t\tdemand.configure({ cache: true, base: '/', pattern: { '/demand': resolveUrl(((configuration && configuration.url) || location.href) + '/../').slice(0, -1)} });\n\t\tconfiguration && configuration.settings && demand.configure(configuration.settings);\n\t\t\n\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isArray', isArray);\n\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isObject', isObject);\n\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isTypeOf', isTypeOf);\n\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isInstanceOf', isInstanceOf);\n\t\tassignModule(MODULE_PREFIX_VALIDATOR + 'isPositiveInteger', isPositiveInteger);\n\t\tassignModule(MODULE_PREFIX_FUNCTION + 'merge', merge);\n\t\tassignModule(MODULE_PREFIX_FUNCTION + 'iterate', iterate);\n\t\tassignModule(MODULE_PREFIX + 'pledge', Pledge);\n\t\tassignModule(MODULE_PREFIX + 'failure', Failure);\n\t\t\n\t\tqueue = new Queue();\n\t\t\n\t\tglobal.demand  = demand;\n\t\tglobal.provide = provide;\n\t\t\n\t\tif(configuration && configuration.main) {\n\t\t\tdemand(configuration.main);\n\t\t}\n}(this, document, 'demand' in this && demand, JSON, XMLHttpRequest, Array.prototype, Object.prototype));"]}