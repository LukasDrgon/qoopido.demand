{"version":3,"sources":["demand.js","include/function/isTypeOf.js","include/function/isPositiveInteger.js","include/function/iterate.js","include/class/descriptor.js","include/function/getTimestamp.js","include/constants.js","include/shortcuts.js","include/function/resolveUrl.js","include/function/isObject.js","include/function/merge.js","include/class/uuid.js","include/function/defer.js","include/class/pledge.js","include/variables.js","include/function/escapeRegularExpression.js","include/class/registry.js","include/class/event.js","include/class/cache.js","include/class/dependency.js","include/class/pattern.js","include/class/loader.js","include/demand.js"],"names":["global","document","options","isTypeOf","object","type","isPositiveInteger","value","STRING_NUMBER","isFinite","Math","floor","iterate","callback","context","property","properties","Object","keys","i","UNDEFINED","call","FALSE","Descriptor","writable","configurable","enumerable","__proto__","NULL","getTimestamp","Date","settings","cache","timeout","pattern","modules","handler","DEMAND_ID","undefined","TRUE","STRING_UNDEFINED","STRING_STRING","STRING_BOOLEAN","STRING_OBJECT","STRING_FUNCTION","FUNCTION_EMPTY","EVENT_PREFIX","EVENT_POSTFIX","EVENT_CONFIGURE","EVENT_PRE_CONFIGURE","EVENT_POST_CONFIGURE","EVENT_CACHE","EVENT_CACHE_MISS","EVENT_CACHE_HIT","EVENT_CACHE_CLEAR","EVENT_CACHE_EXCEED","arrayPrototype","Array","prototype","arrayPrototypeSlice","slice","arrayPrototypeConcat","concat","resolveUrl","create","defineProperty","getOwnPropertyNames","getOwnPropertyDescriptor","Function","url","resolver","href","createElement","isObject","merge","mergeProperties","targetPropertyIsObject","targetProperty","this","length","target","arguments","Uuid","randomize","character","r","random","toString","objectDefineProperty","regex","RegExp","storage","generate","result","replace","set","uuid","defer","element","fallback","hasSetImmediate","fn","MutationObserver","observe","attributes","setAttribute","onMessage","event","source","data","addEventListener","postMessage","onreadystatechange","parentNode","removeChild","body","appendChild","setImmediate","setTimeout","Pledge","resolve","handle","PLEDGE_RESOLVED","reject","PLEDGE_REJECTED","state","parameter","pointer","self","listener","PLEDGE_PENDING","shift","apply","then","deferred","pledge","index","resolved","count","check","rejected","push","total","executor","bind","catch","always","alwaysListener","resolveListener","rejectListener","isPending","isResolved","isRejected","all","pledges","race","regexIsAbsoluteUri","escapeRegularExpression","regexMatchRegex","Registry","get","key","Event","regexMatchEvent","emit","filter","item","on","events","split","test","cachingEnabled","dependency","match","path","indexOf","weight","Cache","STORAGE_PREFIX","STORAGE_SUFFIX_STATE","STORAGE_SUFFIX_VALUE","regexMatchState","supportsLocalStorage","localStorage","exception","supportsRemainingSpace","id","JSON","parse","getItem","version","expires","lifetime","clear","spaceBefore","remainingSpace","setItem","stringify","Error","error","removeItem","expired","Dependency","resolvePath","uri","regexMatchParameter","regexIsAbsolutePath","regexMatchBaseUrl","mock","registry","Pattern","regexMatchTrailingSlash","matchPattern","matchUrl","matches","remove","process","Loader","console","log","demand","dependencies","configure","temp","base","min","max","/demand","location","main"],"mappings":"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","file":"demand.js","sourcesContent":["/**\n * @todo eventually convert settings to class\n * @todo add garbage collection to storage (based on \"last access\")\n */\n\n/**\n * Qoopido demand\n *\n * Promise like module loader (XHR) with localStorage caching\n *\n * Copyright (c) 2016 Dirk Lueth\n *\n * Dual licensed under the MIT and GPL licenses.\n *  - http://www.opensource.org/licenses/mit-license.php\n *  - http://www.gnu.org/copyleft/gpl.html\n *\n * @author Dirk Lueth <info@qoopido.com>\n *\n * @todo add garbage collection to storage (based on \"last access\")\n * @todo check genie for what happens if a single module is in cache, but not yet requested\n */\n\n/* global demand, resolveUrl, TRUE */\n\n(function(global, document, options) {\n\t'use strict';\n\n\tvar settings = { cache: {}, timeout: 8000, pattern: {}, modules: {}, handler: 'module' };\n\n\t//=require constants.js\n\t//=require shortcuts.js\n\t//=require function/resolveUrl.js\n\t//=require demand.js\n\n\t/**\n\t * --------------------------------\n\t * Initialization\n\t * --------------------------------\n\t */\n\t\t(function() {\n\t\t\tglobal.demand  = demand;\n\n\t\t\tdemand.configure({ cache: TRUE, base: '/', pattern: { '/demand': resolveUrl(((options && options.url) || location.href) + '/../').slice(0, -1)} });\n\t\t\toptions && options.settings && demand.configure(options.settings);\n\n\t\t\tif(options && options.main) {\n\t\t\t\tdemand(options.main);\n\t\t\t}\n\t\t}());\n}(this, document, 'demand' in this && demand));","/**\n * isTypeOf\n *\n * Check whether a given object is of specified type\n *\n * @param object\n * @param {string} type\n *\n * @return {boolean}\n */\n\n/* global global, document, settings */\n\nfunction isTypeOf(object, type) {\n\treturn typeof object === type;\n}","/**\n * isPositiveInteger\n *\n * Check whether a given value is a positive integer\n *\n * @param value\n *\n * @return {boolean}\n */\n\n/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global STRING_NUMBER */\n\n/* functions */\n\t//=require function/isTypeOf.js\n\t/* global isTypeOf */\n\nfunction isPositiveInteger(value) {\n\treturn isTypeOf(value, STRING_NUMBER) && isFinite(value) && Math.floor(value) === value && value >= 0;\n}","/**\n * iterate\n *\n * Iterate over enumerable & own properties of a given\n * object and pass current property as well as its value\n * to a callback function\n *\n * @param {object} object\n * @param {function} callback\n * @param context\n *\n * @return {object}\n */\n\n/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global UNDEFINED, FALSE */\n\nfunction iterate(object, callback, context) {\n\tvar properties = Object.keys(object),\n\t\ti = 0, property;\n\n\tfor(; (property = properties[i]) !== UNDEFINED; i++) {\n\t\tif(callback.call(context, property, object[property]) === FALSE) {\n\t\t\tbreak;\n\t\t}\n\t}\n}","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global NULL */\n\nfunction Descriptor(value, writable, configurable, enumerable) {\n\treturn {\n\t\t__proto__:    NULL,\n\t\tvalue:        value,\n\t\tenumerable:   !!enumerable,\n\t\tconfigurable: !!configurable,\n\t\twritable:     !!writable\n\t};\n}","/* global global, document, settings */\n\nfunction getTimestamp() {\n\treturn +new Date();\n}","var DEMAND_ID            = 'demand',\n\tNULL                 = null,\n\tUNDEFINED            = undefined,\n\tFALSE                = false,\n\tTRUE                 = true,\n\tSTRING_UNDEFINED     = 'undefined',\n\tSTRING_STRING        = 'string',\n\tSTRING_BOOLEAN       = 'boolean',\n\tSTRING_OBJECT        = 'object',\n\tSTRING_FUNCTION      = 'function',\n\tSTRING_NUMBER        = 'number',\n\tFUNCTION_EMPTY       = function() {},\n\tEVENT_PREFIX         = 'pre',\n\tEVENT_POSTFIX        = 'post',\n\tEVENT_CONFIGURE      = 'Configure',\n\tEVENT_PRE_CONFIGURE  = EVENT_PREFIX + EVENT_CONFIGURE,\n\tEVENT_POST_CONFIGURE = EVENT_POSTFIX + EVENT_CONFIGURE,\n\tEVENT_CACHE          = 'cache',\n\tEVENT_CACHE_MISS     = EVENT_CACHE + 'Miss',\n\tEVENT_CACHE_HIT      = EVENT_CACHE + 'Hit',\n\tEVENT_CACHE_CLEAR    = EVENT_CACHE + 'Clear',\n\tEVENT_CACHE_EXCEED   = EVENT_CACHE + 'Exceed';","var arrayPrototype                 = Array.prototype,\n\tarrayPrototypeSlice            = arrayPrototype.slice,\n\tarrayPrototypeConcat           = arrayPrototype.concat,\n\tobjectPrototype                = Object.prototype,\n\tobjectCreate                   = Object.create,\n\tobjectDefineProperty           = Object.defineProperty,\n\tobjectGetOwnPropertyNames      = Object.getOwnPropertyNames,\n\tobjectGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor,\n\tfunctionPrototype              = Function.prototype;","/* global global, document, settings */\n\nvar resolveUrl = (function() {\n\tvar resolver = document.createElement('a');\n\n\tfunction resolveUrl(url) {\n\t\tresolver.href = url;\n\n\t\treturn resolver.href;\n\t}\n\n\treturn resolveUrl;\n}());","/**\n * isObject\n *\n * Check whether a given object is of type object\n *\n * @param object\n *\n * @return {boolean}\n */\n\n/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global STRING_OBJECT */\n\n/* functions */\n\t//=require function/isTypeOf.js\n\t/* global isTypeOf */\n\nvar isObject = (function() {\n\tfunction isObject(object) {\n\t\treturn object && isTypeOf(object, STRING_OBJECT);\n\t}\n\n\treturn isObject;\n}());","/**\n * merge\n *\n * Merge two or more objects into the first one passed in\n *\n * @param {...object} object\n *\n * @return {object}\n */\n\n/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global UNDEFINED */\n\n/* functions */\n\t//=require function/isObject.js\n\t//=require function/iterate.js\n\t/* global isObject, iterate */\n\nvar merge = (function() {\n\tfunction mergeProperties(property, value) {\n\t\tvar targetProperty = this[property],\n\t\t\ttargetPropertyIsObject;\n\n\t\tif(value !== UNDEFINED) {\n\t\t\tif(isObject(value)) {\n\t\t\t\ttargetPropertyIsObject = isObject(targetProperty);\n\n\t\t\t\tif(value.length !== UNDEFINED) {\n\t\t\t\t\ttargetProperty = (targetPropertyIsObject && targetProperty.length !== UNDEFINED) ? targetProperty : [];\n\t\t\t\t} else {\n\t\t\t\t\ttargetProperty = (targetPropertyIsObject && targetProperty.length === UNDEFINED) ? targetProperty : {};\n\t\t\t\t}\n\n\t\t\t\tthis[property] = merge(targetProperty, value);\n\t\t\t} else {\n\t\t\t\tthis[property] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction merge() {\n\t\tvar target = arguments[0],\n\t\t\ti = 1, properties;\n\n\t\tfor(; (properties = arguments[i]) !== UNDEFINED; i++) {\n\t\t\titerate(properties, mergeProperties, target);\n\t\t}\n\n\t\treturn target;\n\t}\n\n\treturn merge;\n}());","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global STRING_UNDEFINED */\n\n/* functions */\n\t//=require function/isTypeOf.js\n\t/* global isTypeOf */\n\n/* classes */\n\t//=require class/descriptor.js\n\t/* global Descriptor */\n\nvar Uuid = (function() {\n\tvar objectDefineProperty = Object.defineProperty,\n\t\tregex                = new RegExp('[xy]', 'g'),\n\t\tstorage              = {};\n\n\tfunction randomize(character) {\n\t\tvar r = Math.random() * 16 | 0;\n\n\t\treturn ((character === 'x') ? r : (r & 0x3 | 0x8)).toString(16);\n\t}\n\n\tfunction Uuid() {}\n\n\tUuid.prototype = {\n\t\tgenerate: function() {\n\t\t\tvar result;\n\n\t\t\tdo {\n\t\t\t\tresult = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, randomize);\n\t\t\t} while(storage[result]);\n\n\t\t\tstorage[result] = 1;\n\n\t\t\treturn result;\n\t\t},\n\t\tset: function(target) {\n\t\t\tif(isTypeOf(target.uuid, STRING_UNDEFINED)) {\n\t\t\t\tobjectDefineProperty(target, 'uuid', new Descriptor(this.generate()));\n\t\t\t}\n\n\t\t\treturn target.uuid;\n\t\t}\n\t};\n\n\treturn new Uuid();\n}());","/**\n * defer\n *\n * delay function execution like setImmediate does\n *\n * @param {function} function\n */\n\n/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global NULL, TRUE, FALSE */\n\n/* classes */\n\t//=require class/uuid.js\n\t/* global Uuid */\n\nvar defer = (function() {\n\tvar hasSetImmediate = 'setImmediate' in global,\n\t\telement, fallback;\n\n\tif('MutationObserver' in global) {\n\t\treturn function(fn) {\n\t\t\telement = document.createElement('div');\n\n\t\t\tnew MutationObserver(function() { fn(); })\n\t\t\t\t.observe(element, { attributes: TRUE });\n\n\t\t\telement.setAttribute('i', '1');\n\t\t};\n\t}\n\n\tif(!hasSetImmediate && 'postMessage' in global && !('importScripts' in global) && 'addEventListener' in global) {\n\t\treturn (function() {\n\t\t\tvar storage = {};\n\n\t\t\tfunction onMessage(event) {\n\t\t\t\tif(event.source === global && event.data && storage[event.data]) {\n\t\t\t\t\tstorage[event.data]();\n\n\t\t\t\t\tdelete storage[event.data];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tglobal.addEventListener('message', onMessage, FALSE);\n\n\t\t\treturn function(fn) {\n\t\t\t\tvar uuid = Uuid.generate();\n\n\t\t\t\tstorage[uuid] = fn;\n\n\t\t\t\tglobal.postMessage(uuid, '*');\n\t\t\t}\n\t\t}());\n\t}\n\n\tif(!hasSetImmediate && 'onreadystatechange' in (element = document.createElement('script'))) {\n\t\treturn function(fn) {\n\t\t\telement.onreadystatechange = function onreadystatechange() {\n\t\t\t\telement.onreadystatechange = NULL;\n\t\t\t\telement.parentNode.removeChild(element);\n\n\t\t\t\tfn();\n\t\t\t};\n\n\t\t\tdocument.body.appendChild(element);\n\t\t};\n\t}\n\n\t/* eslint-disable no-undef */\n\tfallback = hasSetImmediate ? setImmediate : setTimeout;\n\t/* eslint-enable no-undef */\n\n\treturn function(fn) {\n\t\tfallback(fn);\n\t}\n}());","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global FUNCTION_EMPTY, NULL */\n\n/* shortcuts */\n\t//=require shortcuts.js\n\t/* global arrayPrototypeSlice, arrayPrototypeConcat */\n\n/* functions */\n\t//=require function/defer.js\n\t/* global defer */\n\n/* classes */\n\t//=require class/uuid.js\n\t/* global Uuid */\n\nvar Pledge = (function() {\n\tvar PLEDGE_PENDING  = 'pending',\n\t\tPLEDGE_RESOLVED = 'resolved',\n\t\tPLEDGE_REJECTED = 'rejected',\n\t\tstorage         = {};\n\n\tfunction resolve() {\n\t\tstorage[this.uuid].handle(PLEDGE_RESOLVED, arguments);\n\t}\n\n\tfunction reject() {\n\t\tstorage[this.uuid].handle(PLEDGE_REJECTED, arguments);\n\t}\n\n\tfunction handle(state, parameter) {\n\t\tvar self     = this,\n\t\t\tlistener = storage[self.uuid],\n\t\t\tpointer, result;\n\n\t\tif(self.state === PLEDGE_PENDING) {\n\t\t\tself.state = state;\n\t\t\tself.value = parameter;\n\t\t}\n\n\t\twhile(pointer = listener[self.state].shift()) {\n\t\t\tresult = pointer.handler.apply(NULL, self.value);\n\n\t\t\tif(result && typeof result.then === 'function') {\n\t\t\t\tresult.then(pointer.deferred.resolve, pointer.deferred.reject);\n\t\t\t} else {\n\t\t\t\tpointer.deferred[self.state === PLEDGE_RESOLVED ? 'resolve' : 'reject'].apply(NULL, self.value);\n\t\t\t}\n\t\t}\n\n\t\tlistener[PLEDGE_RESOLVED].length = 0;\n\t\tlistener[PLEDGE_REJECTED].length = 0;\n\t}\n\n\tfunction observe(pledge, index, properties) {\n\t\tpledge.then(\n\t\t\tfunction() {\n\t\t\t\tproperties.resolved[index] = arrayPrototypeSlice.call(arguments);\n\n\t\t\t\tproperties.count++;\n\n\t\t\t\tcheck(properties);\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\tproperties.rejected.push(arrayPrototypeSlice.call(arguments));\n\n\t\t\t\tcheck(properties);\n\t\t\t}\n\t\t);\n\t}\n\n\tfunction check(properties) {\n\t\tif(properties.count === properties.total) {\n\t\t\tproperties.deferred.resolve.apply(NULL, arrayPrototypeConcat.apply([], properties.resolved));\n\t\t} else if(properties.rejected.length + properties.count === properties.total) {\n\t\t\tproperties.deferred.reject.apply(NULL, arrayPrototypeConcat.apply([], properties.rejected));\n\t\t}\n\t}\n\n\tfunction Pledge(executor) {\n\t\tvar self = this;\n\n\t\tstorage[Uuid.set(self)] = { handle: handle.bind(self), resolved: [], rejected: [] };\n\n\t\texecutor(resolve.bind(self), reject.bind(self));\n\t}\n\n\tPledge.prototype = {\n\t\t/* only for reference\n\t\t uuid:   NULL,\n\t\t value:  NULL,\n\t\t cache:  NULL, // will only be set by storage\n\t\t */\n\t\tstate:  PLEDGE_PENDING,\n\t\t'catch': function(listener) {\n\t\t\treturn this.then(FUNCTION_EMPTY, listener);\n\t\t},\n\t\talways: function(alwaysListener) {\n\t\t\treturn this.then(alwaysListener, alwaysListener);\n\t\t},\n\t\tthen: function(resolveListener, rejectListener) {\n\t\t\tvar self       = this,\n\t\t\t\tproperties = storage[self.uuid],\n\t\t\t\tdeferred   = Pledge.defer();\n\n\t\t\tresolveListener && properties[PLEDGE_RESOLVED].push({ handler: resolveListener, deferred: deferred });\n\t\t\trejectListener && properties[PLEDGE_REJECTED].push({ handler: rejectListener, deferred: deferred });\n\n\t\t\tif(self.state !== PLEDGE_PENDING) {\n\t\t\t\tdefer(properties.handle);\n\t\t\t}\n\n\t\t\treturn deferred.pledge;\n\t\t},\n\t\tisPending: function() {\n\t\t\treturn this.state === PLEDGE_PENDING;\n\t\t},\n\t\tisResolved: function() {\n\t\t\treturn this.state === PLEDGE_RESOLVED;\n\t\t},\n\t\tisRejected: function() {\n\t\t\treturn this.state === PLEDGE_REJECTED;\n\t\t}\n\t};\n\n\tPledge.defer = function() {\n\t\tvar self = {};\n\n\t\tself.pledge = new Pledge(function(resolveListener, rejectListener) {\n\t\t\tself.resolve = resolveListener;\n\t\t\tself.reject  = rejectListener;\n\t\t});\n\n\t\treturn self;\n\t};\n\n\tPledge.all = function(pledges) {\n\t\tvar deferred   = Pledge.defer(),\n\t\t\tproperties = (storage[Uuid.generate()] = { deferred: deferred, resolved: [], rejected: [], total: pledges.length, count: 0 }),\n\t\t\ti = 0, pledge;\n\n\t\tfor(; pledge = pledges[i]; i++) {\n\t\t\tobserve(pledge, i, properties)\n\t\t}\n\n\t\treturn deferred.pledge;\n\t};\n\n\tPledge.race = function(pledges) {\n\t\tvar deferred = Pledge.defer(),\n\t\t\ti = 0, pledge;\n\n\t\tfor(; pledge = pledges[i]; i++) {\n\t\t\tpledge.then(deferred.resolve, deferred.reject);\n\t\t}\n\n\t\treturn deferred.pledge;\n\t};\n\n\treturn Pledge;\n}());","var regexIsAbsoluteUri  = /^(http(s?):)?\\/\\//i;","/* global global, document, settings */\n\nvar escapeRegularExpression = (function() {\n\tvar regexMatchRegex = /[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g;\n\n\tfunction escapeRegularExpression(value) {\n\t\treturn value.replace(regexMatchRegex, '\\\\$&');\n\t}\n\n\treturn escapeRegularExpression;\n}());","/* global global, document, settings */\n\n/* classes */\n\t//=require class/uuid.js\n\t/* global Uuid */\n\nvar Registry = (function() {\n\tvar storage = {};\n\n\tfunction Registry() {\n\t\tvar self = this;\n\n\t\tstorage[Uuid.set(self)] = {};\n\t}\n\n\tRegistry.prototype = {\n\t\tget: function(key) {\n\t\t\treturn storage[this.uuid][key];\n\t\t},\n\t\tset: function(key, value) {\n\t\t\tstorage[this.uuid][key] = value;\n\t\t}\n\t};\n\n\treturn Registry;\n}());","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global NULL, STRING_STRING, STRING_FUNCTION */\n\n/* shortcuts */\n\t//=require shortcuts.js\n\t/* global arrayPrototypeSlice */\n\n/* functions */\n\t//=require function/isTypeOf.js\n\t/* global isTypeOf */\n\nvar event = (function() {\n\tvar regexMatchEvent = /^cache(Miss|Hit|Clear|Exceed)|(pre|post)(Configure.*|Resolve|Request|Process|Cache)$/,\n\t\tlistener        = {};\n\n\tfunction Event() {}\n\n\tEvent.prototype = {\n\t\temit: function (event, filter) {\n\t\t\tvar pointer = listener[event],\n\t\t\t\tparameter, i, item;\n\n\t\t\tif(pointer) {\n\t\t\t\tparameter = arrayPrototypeSlice.call(arguments, 2);\n\n\t\t\t\tfor(i = 0; (item = pointer[i]); i++) {\n\t\t\t\t\tif(!item.filter || item.filter === filter) {\n\t\t\t\t\t\titem.callback.apply(NULL, parameter);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ton: function(events, callback) {\n\t\t\tvar event;\n\n\t\t\tif(isTypeOf(events, STRING_STRING) && isTypeOf(callback, STRING_FUNCTION)) {\n\t\t\t\tevents = events.split(' ');\n\n\t\t\t\twhile(event = events.shift()) {\n\t\t\t\t\tevent = event.split(':');\n\n\t\t\t\t\tif(regexMatchEvent.test(event)) {\n\t\t\t\t\t\t(listener[event[0]] || (listener[event[0]] = [])).push({ callback: callback, filter: event[1] });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn new Event();\n}());\n","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global DEMAND_ID, NULL, FALSE, TRUE, FUNCTION_EMPTY, EVENT_CACHE_HIT, EVENT_CACHE_MISS, EVENT_CACHE_EXCEED, EVENT_CACHE_CLEAR */\n\n/* shortcuts */\n\t//=require shortcuts.js\n\t/* global */\n\n/* functions */\n\t//=require function/getTimestamp.js\n\t//=require function/escapeRegularExpression.js\n\t//=require function/iterate.js\n\t/* global getTimestamp, escapeRegularExpression, iterate */\n\n/* classes */\n\t//=require class/event.js\n\t/* global event */\n\nvar cache = (function() {\n\tvar STORAGE_PREFIX         = '[' + DEMAND_ID + ']',\n\t\tSTORAGE_SUFFIX_STATE   = '[state]',\n\t\tSTORAGE_SUFFIX_VALUE   = '[value]',\n\t\tregexMatchState        = new RegExp('^' + escapeRegularExpression(STORAGE_PREFIX) + '\\\\[(.+?)\\\\]' + escapeRegularExpression(STORAGE_SUFFIX_STATE) + '$'),\n\t\tsupportsLocalStorage   = (function() { try { return 'localStorage' in global && global.localStorage; } catch(exception) { return FALSE; } }()),\n\t\tsupportsRemainingSpace = supportsLocalStorage && 'remainingSpace' in localStorage;\n\n\tfunction cachingEnabled(dependency) {\n\t\tvar match;\n\n\t\tif(dependency.cache !== NULL) {\n\t\t\treturn dependency.cache;\n\t\t}\n\n\t\titerate(settings.cache, function(property, value) {\n\t\t\tif(dependency.path.indexOf(property) === 0 && (!match || value.weight > match.weight)) {\n\t\t\t\tmatch = value;\n\t\t\t}\n\t\t});\n\n\t\treturn match ? match.state : FALSE;\n\t}\n\n\tfunction Cache() {\n\n\t}\n\n\tCache.prototype = {\n\t\tget: (function() {\n\t\t\tif(supportsLocalStorage) {\n\t\t\t\treturn function get(dependency) {\n\t\t\t\t\tvar id, state;\n\n\t\t\t\t\tif(cachingEnabled(dependency)) {\n\t\t\t\t\t\tid    = STORAGE_PREFIX + '[' + dependency.path + ']';\n\t\t\t\t\t\tstate = JSON.parse(localStorage.getItem(id + STORAGE_SUFFIX_STATE));\n\n\t\t\t\t\t\tif(state && state.version === dependency.version && state.url === dependency.url && ((!state.expires && !dependency.lifetime) || state.expires > getTimestamp())) {\n\t\t\t\t\t\t\tevent.emit(EVENT_CACHE_HIT, dependency.path, dependency);\n\n\t\t\t\t\t\t\treturn localStorage.getItem(id + STORAGE_SUFFIX_VALUE);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tevent.emit(EVENT_CACHE_MISS, dependency.path, dependency);\n\n\t\t\t\t\t\t\tstate && this.clear.path(dependency.path);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevent.emit(EVENT_CACHE_MISS, dependency.path, dependency);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn function get(dependency) {\n\t\t\t\t\tevent.emit(EVENT_CACHE_MISS, dependency.path, dependency);\n\t\t\t\t};\n\t\t\t}\n\t\t}()),\n\t\tset: (function() {\n\t\t\tif(supportsLocalStorage) {\n\t\t\t\treturn function set(dependency, source) {\n\t\t\t\t\tvar id, spaceBefore;\n\n\t\t\t\t\tif(cachingEnabled(dependency)) {\n\t\t\t\t\t\tid = STORAGE_PREFIX + '[' + dependency.path + ']';\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tspaceBefore = supportsRemainingSpace ? localStorage.remainingSpace : NULL;\n\n\t\t\t\t\t\t\tlocalStorage.setItem(id + STORAGE_SUFFIX_VALUE, source);\n\t\t\t\t\t\t\tlocalStorage.setItem(id + STORAGE_SUFFIX_STATE, JSON.stringify({ version: dependency.version, expires: dependency.lifetime ? getTimestamp() + dependency.lifetime : dependency.lifetime, url: dependency.url }));\n\n\t\t\t\t\t\t\t// strict equality check with \"===\" is required due to spaceBefore might be \"0\"\n\t\t\t\t\t\t\tif(spaceBefore !== NULL && localStorage.remainingSpace === spaceBefore) {\n\t\t\t\t\t\t\t\tthrow new Error('QUOTA_EXCEEDED_ERR');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn TRUE;\n\t\t\t\t\t\t} catch(error) {\n\t\t\t\t\t\t\tevent.emit(EVENT_CACHE_EXCEED, dependency.path, dependency);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn FUNCTION_EMPTY;\n\t\t\t}\n\t\t}()),\n\t\tclear: {\n\t\t\tpath: (function() {\n\t\t\t\tif(supportsLocalStorage) {\n\t\t\t\t\treturn function path(path) {\n\t\t\t\t\t\tvar id = STORAGE_PREFIX + '[' + path + ']';\n\n\t\t\t\t\t\tlocalStorage.removeItem(id + STORAGE_SUFFIX_STATE);\n\t\t\t\t\t\tlocalStorage.removeItem(id + STORAGE_SUFFIX_VALUE);\n\n\t\t\t\t\t\tevent.emit(EVENT_CACHE_CLEAR, path);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn FUNCTION_EMPTY;\n\t\t\t\t}\n\t\t\t}()),\n\t\t\tall: (function() {\n\t\t\t\tif(supportsLocalStorage) {\n\t\t\t\t\treturn function all() {\n\t\t\t\t\t\tvar match;\n\n\t\t\t\t\t\titerate(localStorage, function(property) {\n\t\t\t\t\t\t\tmatch = property.match(regexMatchState);\n\n\t\t\t\t\t\t\tmatch && this.path(match[1]);\n\t\t\t\t\t\t}, this);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn FUNCTION_EMPTY;\n\t\t\t\t}\n\t\t\t}()),\n\t\t\texpired: (function() {\n\t\t\t\tif(supportsLocalStorage) {\n\t\t\t\t\treturn function expired() {\n\t\t\t\t\t\tvar match, state;\n\n\t\t\t\t\t\titerate(localStorage, function(property) {\n\t\t\t\t\t\t\tmatch = property.match(regexMatchState);\n\n\t\t\t\t\t\t\tif(match) {\n\t\t\t\t\t\t\t\tstate = JSON.parse(localStorage.getItem(STORAGE_PREFIX + '[' + match[1] + ']' + STORAGE_SUFFIX_STATE));\n\n\t\t\t\t\t\t\t\tif(state && state.expires > 0 && state.expires <= getTimestamp()) {\n\t\t\t\t\t\t\t\t\tthis.path(match[1]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn FUNCTION_EMPTY;\n\t\t\t\t}\n\t\t\t}())\n\t\t}\n\t};\n\n\treturn new Cache();\n}());","/* global global, document, settings */\n\n/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global NULL, TRUE, FALSE */\n\n/* variables */\n\t//=require variables.js\n\t/* global regexIsAbsoluteUri */\n\n/* functions */\n\t//=require function/isPositiveInteger.js\n\t//=require function/resolveUrl.js\n\t//=require function/escapeRegularExpression.js\n\t/* global isPositiveInteger, resolveUrl, escapeRegularExpression */\n\n/* classes */\n\t//=require class/registry.js\n\t//=require class/pledge.js\n\t//=require class/cache.js\n\t/* global Registry, Pledge, cache */\n\nvar Dependency = (function() {\n\tvar registry            = new Registry(),\n\t\tregexMatchParameter = /^(mock:)?([+-])?((?:[-\\w]+\\/?)+)?(?:@(\\d+\\.\\d+.\\d+))?(?:#(\\d+))?!/,\n\t\tregexMatchBaseUrl   = new RegExp('^' + escapeRegularExpression(resolveUrl('/'))),\n\t\tregexIsAbsolutePath = /^\\//;\n\n\tfunction resolvePath(uri, context) {\n\t\tvar path = uri.replace(regexMatchParameter, '');\n\n\t\tif(!regexIsAbsolutePath.test(path) && !regexIsAbsoluteUri.test(path)) {\n\t\t\tpath = '/' + resolveUrl(((context && resolveUrl(context + '/../')) || '/') + path).replace(regexMatchBaseUrl, '');\n\t\t}\n\n\t\treturn path;\n\t}\n\n\tfunction Dependency(uri, context) {\n\t\tvar self      = this,\n\t\t\tparameter = uri.match(regexMatchParameter);\n\n\t\tself.deferred = Pledge.defer();\n\t\tself.pledge   = self.deferred.pledge;\n\t\tself.path     = resolvePath(uri, context);\n\t\tself.mock     = (parameter && parameter[1]) ? TRUE : FALSE;\n\t\tself.cache    = (parameter && parameter[2]) ? parameter[2] === '+' : NULL;\n\t\tself.handler  = (parameter && parameter[3]) || settings.handler;\n\t\tself.version  = (parameter && parameter[4]) || settings.version;\n\t\tself.lifetime = (parameter && parameter[5] && parameter[5] * 1000) || settings.lifetime;\n\t\tself.uri      = (self.mock ? 'mock:' : '') + self.handler + '@' + self.version + (isPositiveInteger(self.lifetime) && self.lifetime > 0 ? '#' + self.lifetime : '' ) + '!' + self.path;\n\n\t\tcache.get(self);\n\n\t\treturn self;\n\t}\n\n\t/* only for reference\n\tDependency.prototype = {\n\t\t deferred: NULL,\n\t\t pledge:   NULL,\n\t\t path:     NULL,\n\t\t mock:     NULL,\n\t\t cache:    NULL,\n\t\t handler:  NULL,\n\t\t version:  NULL,\n\t\t lifetime: NULL,\n\t\t uri:      NULL,\n\t};\n\t*/\n\n\tDependency.resolve = function(uri, context) {\n\t\tvar path       = resolvePath(uri, context),\n\t\t\tdependency = registry.get(path);\n\n\t\tif(!dependency) {\n\t\t\tdependency = new Dependency(uri, context);\n\t\t}\n\n\t\treturn dependency.pledge;\n\t};\n\n\treturn Dependency;\n}());","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global STRING_BOOLEAN, STRING_STRING, NULL */\n\n/* shortcuts */\n\t//=require shortcuts.js\n\t/* global arrayPrototypeSlice */\n\n/* functions */\n\t//=require function/resolveUrl.js\n\t//=require function/escapeRegularExpression.js\n\t/* global resolveUrl, escapeRegularExpression */\n\nvar Pattern = (function() {\n\tvar regexMatchTrailingSlash = /(.+)\\/$/;\n\n\tfunction Pattern(pattern, url) {\n\t\tvar self = this;\n\n\t\tself.weight       = pattern.length;\n\t\tself.url          = resolveUrl(url).replace(regexMatchTrailingSlash, '$1');\n\t\tself.matchPattern = new RegExp('^' + escapeRegularExpression(pattern));\n\t\tself.matchUrl     = new RegExp('^' + escapeRegularExpression(url));\n\t}\n\n\tPattern.prototype = {\n\t\t/* only for reference\n\t\t weight:       0,\n\t\t url:          NULL,\n\t\t matchPattern: NULL,\n\t\t matchUrl:     NULL,\n\t\t */\n\t\tmatches: function(path) {\n\t\t\treturn this.matchPattern.test(path);\n\t\t},\n\t\tremove: function(url) {\n\t\t\treturn url.replace(this.matchUrl, '');\n\t\t},\n\t\tprocess: function(path) {\n\t\t\treturn path.replace(this.matchPattern, this.url);\n\t\t}\n\t};\n\n\treturn Pattern;\n}());","/* global global, document, settings */\n\n/* variables */\n\t//=require variables.js\n\t/* global regexIsAbsoluteUri */\n\n/* functions */\n\t//=require function/iterate.js\n\t//=require function/resolveUrl.js\n\t/* global iterate, resolveUrl */\n\nvar Loader = (function() {\n\tfunction Loader(dependency) {\n\t\tvar self = this,\n\t\t\tpattern;\n\n\t\tif(!regexIsAbsoluteUri.test(dependency.path)) {\n\t\t\titerate(settings.pattern, function(property, value) {\n\t\t\t\tvalue.matches(dependency.path) && (!pattern || pattern.weight < value.weight) && (pattern = value);\n\t\t\t});\n\t\t}\n\n\t\tself.dependency = dependency;\n\t\tself.pattern    = pattern;\n\t\tself.url        = pattern ? resolveUrl(pattern.process(dependency.path)) : dependency.path;\n\n\t\tconsole.log('hier', self);\n\t}\n\n\t/* only for reference\n\tLoader.prototype = {\n\t\tdependency: NULL,\n\t \tpattern:    NULL\n\t};\n\t*/\n\n\treturn Loader;\n}());","/* global global, document, settings */\n\n/* constants */\n\t//=require constants.js\n\t/* global STRING_BOOLEAN, STRING_STRING, STRING_FUNCTION, NULL, EVENT_PRE_CONFIGURE, EVENT_POST_CONFIGURE, EVENT_CACHE_MISS */\n\n/* shortcuts */\n\t//=require shortcuts.js\n\t/* global arrayPrototypeSlice */\n\n/* functions */\n\t//=require function/isTypeOf.js\n\t//=require function/isObject.js\n\t//=require function/isPositiveInteger.js\n\t//=require function/iterate.js\n\t//=require function/merge.js\n\t/* global isTypeOf, isObject, isPositiveInteger, iterate, merge */\n\n/* classes */\n\t//=require class/pledge.js\n\t//=require class/dependency.js\n\t//=require class/pattern.js\n\t//=require class/loader.js\n\t//=require class/event.js\n\t/* global Pledge, Dependency, Pattern, Loader, event */\n\nvar demand = (function() {\n\tfunction demand() {\n\t\tvar dependencies = arrayPrototypeSlice.call(arguments),\n\t\t\tcontext      = this !== global ? this : NULL,\n\t\t\ti = 0, uri;\n\n\t\tfor(; (uri = dependencies[i]); i++) {\n\t\t\tdependencies[i] = Dependency.resolve(uri, context);\n\t\t}\n\n\t\treturn Pledge.all(dependencies);\n\t}\n\n\tdemand.configure = function(options) {\n\t\tvar cache    = options.cache,\n\t\t\tversion  = options.version,\n\t\t\ttimeout  = options.timeout,\n\t\t\tlifetime = options.lifetime,\n\t\t\tbase     = options.base,\n\t\t\tpattern  = options.pattern,\n\t\t\tmodules  = options.modules,\n\t\t\tpointer  = settings.modules,\n\t\t\ttemp;\n\n\t\tif(isTypeOf(cache, STRING_BOOLEAN)) {\n\t\t\tsettings.cache[''] = { weight: 0, state: cache };\n\t\t} else if(isObject(cache)) {\n\t\t\titerate(cache, function(property, value) {\n\t\t\t\tsettings.cache[property] = { weight: property.length, state: value };\n\t\t\t});\n\t\t}\n\n\t\tif(isTypeOf(version, STRING_STRING)) {\n\t\t\tsettings.version = version;\n\t\t}\n\n\t\tif(isPositiveInteger(timeout)) {\n\t\t\tsettings.timeout = Math.min(Math.max(timeout, 2), 12) * 1000;\n\t\t}\n\n\t\tif(isPositiveInteger(lifetime) && lifetime > 0) {\n\t\t\tsettings.lifetime = lifetime * 1000;\n\t\t}\n\n\t\tif(isTypeOf(base, STRING_STRING) && base !== '') {\n\t\t\tsettings.pattern.base = new Pattern('', base);\n\t\t}\n\n\t\tif(isObject(pattern)) {\n\t\t\titerate(pattern, function(property, value) {\n\t\t\t\tproperty !== 'base' && (settings.pattern[property] = new Pattern(property, value));\n\t\t\t});\n\t\t}\n\n\t\tif(isObject(modules)) {\n\t\t\titerate(modules, function(property, value) {\n\t\t\t\ttemp = pointer[property] = pointer[property] || {};\n\n\t\t\t\tevent.emit(EVENT_PRE_CONFIGURE, property, temp);\n\n\t\t\t\tmerge(temp, value);\n\n\t\t\t\tevent.emit(EVENT_POST_CONFIGURE, property, temp);\n\t\t\t});\n\t\t}\n\n\t\treturn demand;\n\t};\n\n\tdemand.on = function(events, callback) {\n\t\tevent.on(events, callback);\n\n\t\treturn demand;\n\t};\n\n\tdemand\n\t\t.on(EVENT_CACHE_MISS, function(dependency) {\n\t\t\tnew Loader(dependency);\n\t\t});\n\n\treturn demand;\n}());"]}